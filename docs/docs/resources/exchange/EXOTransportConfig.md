# EXOTransportConfig

## Parameters

| Parameter | Attribute | DataType | Description | Allowed Values |
| --- | --- | --- | --- | --- |
| **IsSingleInstance** | Key | String | Specifies the resource is a single instance, the value must be 'Yes'. | `Yes` |
| **AddressBookPolicyRoutingEnabled** | Write | Boolean | The AddressBookPolicyRoutingEnabled parameter controls how recipients are resolved in an organization that uses address book policies to create separate virtual organizations within the same Exchange organization. | |
| **AllowLegacyTLSClients** | Write | Boolean | Allow legacy TLS clients | |
| **ClearCategories** | Write | Boolean | The ClearCategories parameter keeps or removes Microsoft Outlook message categories during content conversion. | |
| **ConvertDisclaimerWrapperToEml** | Write | Boolean | The ConvertDisclaimerWrapperToEml parameter specifies whether the original message will be added as a TNEF attachment or a regular EML attachment to a disclaimer. | |
| **DSNConversionMode** | Write | String | The DSNConversionMode parameter controls how Exchange handles delivery status notifications that are generated by earlier versions of Exchange or other messaging systems. | |
| **ExternalDelayDsnEnabled** | Write | Boolean | The ExternalDelayDsnEnabled parameter specifies whether a delay delivery status notification (DSN) message should be created for external messages that couldn't be immediately delivered.  | |
| **ExternalDsnDefaultLanguage** | Write | String | The ExternalDsnDefaultLanguage parameter specifies which Exchange server language should be used by default when you create external DSN messages. | |
| **ExternalDsnLanguageDetectionEnabled** | Write | Boolean | The ExternalDsnLanguageDetectionEnabled parameter specifies whether the server should try to send an external DSN message in the same language as the original message that generated the notification. | |
| **ExternalDsnReportingAuthority** | Write | String | The ExternalDsnReportingAuthority parameter specifies the domain in the machine-readable part of external DSN messages.  | |
| **ExternalDsnSendHtml** | Write | Boolean | The ExternalDsnSendHtml parameter specifies whether external DSN messages should be HTML or plain text. | |
| **ExternalPostmasterAddress** | Write | String | The ExternalPostmasterAddress parameter specifies the email address in the From header field of an external DSN message. | |
| **HeaderPromotionModeSetting** | Write | String | The HeaderPromotionModeSetting parameter specifies whether named properties are created for custom X-headers on messages received. | |
| **InternalDelayDsnEnabled** | Write | Boolean | The InternalDelayDsnEnabled parameter specifies whether a delay DSN message should be created for messages sent to or from recipients or senders in the same Exchange organization that couldn't be immediately delivered. | |
| **InternalDsnDefaultLanguage** | Write | String | The InternalDsnDefaultLanguage parameter specifies which Exchange server language should be used by default when you create internal DSN messages. | |
| **InternalDsnLanguageDetectionEnabled** | Write | Boolean | The InternalDsnLanguageDetectionEnabled parameter specifies whether the server should try to send an internal DSN message in the same language as the original message that generated the notification. | |
| **InternalDsnReportingAuthority** | Write | String | The InternalDsnReportingAuthority parameter specifies the domain in the machine-readable part of internal DSN messages. | |
| **InternalDsnSendHtml** | Write | Boolean | The InternalDsnSendHtml parameter specifies whether internal DSN messages should be HTML or plain text. | |
| **JournalMessageExpirationDays** | Write | SInt32 | The JournalMessageExpirationDays parameter extends the number of days that undeliverable journal reports are queued before they expire. | |
| **JournalingReportNdrTo** | Write | String | The JournalingReportNdrTo parameter specifies the email address to which journal reports are sent if the journaling mailbox is unavailable. | |
| **MaxRecipientEnvelopeLimit** | Write | String | The MaxRecipientEnvelopeLimit parameter specifies the maximum number of recipients in a message. | |
| **ReplyAllStormBlockDurationHours** | Write | SInt32 | Reply all storm block duration hours. | |
| **ReplyAllStormDetectionMinimumRecipients** | Write | SInt32 | Reply all storm detection minimum recipients. | |
| **ReplyAllStormDetectionMinimumReplies** | Write | SInt32 | Reply all storm detection minimum replies. | |
| **ReplyAllStormProtectionEnabled** | Write | Boolean | Reply all storm protection enabled. | |
| **Rfc2231EncodingEnabled** | Write | Boolean | The Rfc2231EncodingEnabled parameter specifies whether the RFC 2231 encoding of MIME parameters for outbound messages is enabled in your organization. | |
| **SmtpClientAuthenticationDisabled** | Write | Boolean | The SmtpClientAuthenticationDisabled parameter specifies whether to disable authenticated SMTP (SMTP AUTH) for the whole organization. | |
| **Credential** | Write | PSCredential | Credentials of the Exchange Global Admin | |
| **ApplicationId** | Write | String | Id of the Azure Active Directory application to authenticate with. | |
| **TenantId** | Write | String | Id of the Azure Active Directory tenant used for authentication. | |
| **CertificateThumbprint** | Write | String | Thumbprint of the Azure Active Directory application's authentication certificate to use for authentication. | |
| **CertificatePassword** | Write | PSCredential | Username can be made up to anything but password will be used for CertificatePassword | |
| **CertificatePath** | Write | String | Path to certificate used in service principal usually a PFX file. | |
| **ManagedIdentity** | Write | Boolean | Managed ID being used for authentication. | |

## Description

This resource configures the Exchange Online transport
settings.

## Permissions

### Exchange

To authenticate with Microsoft Exchange, this resource required the following permissions:

#### Roles

- Organization Transport Settings, View-Only Configuration, Journaling

#### Role Groups

- Organization Management

## Examples

### Example 1

This example is used to test new resources and showcase the usage of new resources being worked on.
It is not meant to use as a production baseline.

```powershell
Configuration Example
{
    param(
        [Parameter(Mandatory = $true)]
        [PSCredential]
        $Credscredential
    )
    Import-DscResource -ModuleName Microsoft365DSC

    node localhost
    {
        EXOTransportConfig  'EXOTransportConfig '
        {
            IsSingleInstance                        = "Yes";
            AddressBookPolicyRoutingEnabled         = $True;
            ClearCategories                         = $True;
            ConvertDisclaimerWrapperToEml           = $False;
            DSNConversionMode                       = "PreserveDSNBody";
            ExternalDelayDsnEnabled                 = $True;
            ExternalDsnLanguageDetectionEnabled     = $True;
            ExternalDsnSendHtml                     = $True;
            ExternalPostmasterAddress               = "postmaster@contoso.com";
            HeaderPromotionModeSetting              = "NoCreate";
            InternalDelayDsnEnabled                 = $True;
            InternalDsnLanguageDetectionEnabled     = $True;
            InternalDsnSendHtml                     = $True;
            JournalingReportNdrTo                   = "<>";
            JournalMessageExpirationDays            = 0;
            MaxRecipientEnvelopeLimit               = "Unlimited";
            ReplyAllStormBlockDurationHours         = 6;
            ReplyAllStormDetectionMinimumRecipients = 2500;
            ReplyAllStormDetectionMinimumReplies    = 10;
            ReplyAllStormProtectionEnabled          = $True;
            Rfc2231EncodingEnabled                  = $False;
            SmtpClientAuthenticationDisabled        = $True;
            Credential                              = $Credscredential
        }
    }
}
```

