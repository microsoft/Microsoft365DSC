[CmdletBinding()]
param(
)
$M365DSCTestFolder = Join-Path -Path $PSScriptRoot `
    -ChildPath '..\..\Unit' `
    -Resolve
$CmdletModule = (Join-Path -Path $M365DSCTestFolder `
        -ChildPath '\Stubs\Microsoft365.psm1' `
        -Resolve)
$GenericStubPath = (Join-Path -Path $M365DSCTestFolder `
        -ChildPath '\Stubs\Generic.psm1' `
        -Resolve)
Import-Module -Name (Join-Path -Path $M365DSCTestFolder `
        -ChildPath '\UnitTestHelper.psm1' `
        -Resolve)

$Global:DscHelper = New-M365DscUnitTestHelper -StubModule $CmdletModule `
    -DscResource 'IntuneDeviceConfigurationPolicyWindows10' -GenericStubModule $GenericStubPath
Describe -Name $Global:DscHelper.DescribeHeader -Fixture {
    InModuleScope -ModuleName $Global:DscHelper.ModuleName -ScriptBlock {
        Invoke-Command -ScriptBlock $Global:DscHelper.InitializeScript -NoNewScope
        BeforeAll {

            $secpasswd = ConvertTo-SecureString (New-GUID).ToString() -AsPlainText -Force
            $Credential = New-Object System.Management.Automation.PSCredential ('tenantadmin@mydomain.com', $secpasswd)

            Mock -CommandName Confirm-M365DSCDependencies -MockWith {
            }

            Mock -CommandName Get-PSSession -MockWith {
            }

            Mock -CommandName New-MgBetaDeviceManagementDeviceConfiguration -MockWith {
            }

            Mock -CommandName Update-MgBetaDeviceManagementDeviceConfiguration -MockWith {
            }

            Mock -CommandName Remove-MgBetaDeviceManagementDeviceConfiguration -MockWith {
            }

            Mock -CommandName Get-MgBetaDeviceManagementDeviceConfigurationAssignment -MockWith {
                return @()
            }

            Mock -CommandName New-M365DSCConnection -MockWith {
                return 'Credentials'
            }
            Mock -CommandName Update-DeviceConfigurationPolicyAssignment -MockWith {
            }
            # Mock Write-Host to hide output during the tests
            Mock -CommandName Write-Host -MockWith {
            }
            $Script:exportedInstances =$null
            $Script:ExportMode = $false
        }

        # Test contexts
        Context -Name 'The IntuneDeviceConfigurationPolicyWindows10 should exist but it DOES NOT' -Fixture {
            BeforeAll {
                $testParams = @{
                    AccountsBlockAddingNonMicrosoftAccountEmail           = $True
                    ActivateAppsWithVoice                                 = 'notConfigured'
                    AntiTheftModeBlocked                                  = $True
                    AppManagementMSIAllowUserControlOverInstall           = $True
                    AppManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                    AppManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                    AppsAllowTrustedAppsSideloading                       = 'notConfigured'
                    AppsBlockWindowsStoreOriginatedApps                   = $True
                    AuthenticationAllowSecondaryDevice                    = $True
                    AuthenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                    AuthenticationWebSignIn                               = 'notConfigured'
                    BluetoothAllowedServices                              = @('FakeStringValue')
                    BluetoothBlockAdvertising                             = $True
                    BluetoothBlockDiscoverableMode                        = $True
                    BluetoothBlocked                                      = $True
                    BluetoothBlockPrePairing                              = $True
                    BluetoothBlockPromptedProximalConnections             = $True
                    CameraBlocked                                         = $True
                    CellularBlockDataWhenRoaming                          = $True
                    CellularBlockVpn                                      = $True
                    CellularBlockVpnWhenRoaming                           = $True
                    CellularData                                          = 'blocked'
                    CertificatesBlockManualRootCertificateInstallation    = $True
                    ConfigureTimeZone                                     = 'FakeStringValue'
                    ConnectedDevicesServiceBlocked                        = $True
                    CopyPasteBlocked                                      = $True
                    CortanaBlocked                                        = $True
                    CryptographyAllowFipsAlgorithmPolicy                  = $True
                    DataProtectionBlockDirectMemoryAccess                 = $True
                    DefenderBlockEndUserAccess                            = $True
                    DefenderBlockOnAccessProtection                       = $True
                    DefenderCloudBlockLevel                               = 'notConfigured'
                    DefenderCloudExtendedTimeout                          = 25
                    DefenderCloudExtendedTimeoutInSeconds                 = 25
                    DefenderDaysBeforeDeletingQuarantinedMalware          = 25
                    defenderDetectedMalwareActions                        = (New-CimInstance -ClassName MSFT_MicrosoftGraphdefenderDetectedMalwareActions1 -Property @{
                            lowSeverity      = 'deviceDefault'
                            severeSeverity   = 'deviceDefault'
                            moderateSeverity = 'deviceDefault'
                            highSeverity     = 'deviceDefault'
                        } -ClientOnly)
                    defenderDisableCatchupFullScan                        = $True
                    defenderDisableCatchupQuickScan                       = $True
                    defenderFileExtensionsToExclude                       = @('FakeStringValue')
                    defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                    defenderMonitorFileActivity                           = 'userDefined'
                    defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                    defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                    defenderProcessesToExclude                            = @('FakeStringValue')
                    defenderPromptForSampleSubmission                     = 'userDefined'
                    defenderRequireBehaviorMonitoring                     = $True
                    defenderRequireCloudProtection                        = $True
                    defenderRequireNetworkInspectionSystem                = $True
                    defenderRequireRealTimeMonitoring                     = $True
                    defenderScanArchiveFiles                              = $True
                    defenderScanDownloads                                 = $True
                    defenderScanIncomingMail                              = $True
                    defenderScanMappedNetworkDrivesDuringFullScan         = $True
                    defenderScanMaxCpu                                    = 25
                    defenderScanNetworkFiles                              = $True
                    defenderScanRemovableDrivesDuringFullScan             = $True
                    defenderScanScriptsLoadedInInternetExplorer           = $True
                    defenderScanType                                      = 'userDefined'
                    defenderScheduledQuickScanTime                        = '00:00:00'
                    defenderScheduledScanTime                             = '00:00:00'
                    defenderScheduleScanEnableLowCpuPriority              = $True
                    defenderSignatureUpdateIntervalInHours                = 25
                    defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                    defenderSystemScanSchedule                            = 'userDefined'
                    description                                           = 'FakeStringValue'
                    developerUnlockSetting                                = 'notConfigured'
                    deviceManagementBlockFactoryResetOnMobile             = $True
                    deviceManagementBlockManualUnenroll                   = $True
                    diagnosticsDataSubmissionMode                         = 'userDefined'
                    displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                    displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                    displayName                                           = 'FakeStringValue'
                    edgeAllowStartPagesModification                       = $True
                    edgeBlockAccessToAboutFlags                           = $True
                    edgeBlockAddressBarDropdown                           = $True
                    edgeBlockAutofill                                     = $True
                    edgeBlockCompatibilityList                            = $True
                    edgeBlockDeveloperTools                               = $True
                    edgeBlocked                                           = $True
                    edgeBlockEditFavorites                                = $True
                    edgeBlockExtensions                                   = $True
                    edgeBlockFullScreenMode                               = $True
                    edgeBlockInPrivateBrowsing                            = $True
                    edgeBlockJavaScript                                   = $True
                    edgeBlockLiveTileDataCollection                       = $True
                    edgeBlockPasswordManager                              = $True
                    edgeBlockPopups                                       = $True
                    edgeBlockPrelaunch                                    = $True
                    edgeBlockPrinting                                     = $True
                    edgeBlockSavingHistory                                = $True
                    edgeBlockSearchEngineCustomization                    = $True
                    edgeBlockSearchSuggestions                            = $True
                    edgeBlockSendingDoNotTrackHeader                      = $True
                    edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                    edgeBlockSideloadingExtensions                        = $True
                    edgeBlockTabPreloading                                = $True
                    edgeBlockWebContentOnNewTabPage                       = $True
                    edgeClearBrowsingDataOnExit                           = $True
                    edgeCookiePolicy                                      = 'userDefined'
                    edgeDisableFirstRunPage                               = $True
                    edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                    edgeFavoritesBarVisibility                            = 'notConfigured'
                    edgeFavoritesListLocation                             = 'FakeStringValue'
                    edgeFirstRunUrl                                       = 'FakeStringValue'
                    edgeHomeButtonConfiguration                           = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeHomeButtonConfiguration -Property @{
                            odataType           = '#microsoft.graph.edgeHomeButtonHidden'
                            homeButtonCustomURL = 'FakeStringValue'
                        } -ClientOnly)
                    edgeHomeButtonConfigurationEnabled                    = $True
                    edgeHomepageUrls                                      = @('FakeStringValue')
                    edgeKioskModeRestriction                              = 'notConfigured'
                    edgeKioskResetAfterIdleTimeInMinutes                  = 25
                    edgeNewTabPageURL                                     = 'FakeStringValue'
                    edgeOpensWith                                         = 'notConfigured'
                    edgePreventCertificateErrorOverride                   = $True
                    edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                    edgeRequireSmartScreen                                = $True
                    edgeSearchEngine                                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeSearchEngineBase -Property @{
                            edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                            edgeSearchEngineType             = 'default'
                            odataType                        = '#microsoft.graph.edgeSearchEngine'
                        } -ClientOnly)
                    edgeSendIntranetTrafficToInternetExplorer             = $True
                    edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                    edgeSyncFavoritesWithInternetExplorer                 = $True
                    edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                    enableAutomaticRedeployment                           = $True
                    energySaverOnBatteryThresholdPercentage               = 25
                    energySaverPluggedInThresholdPercentage               = 25
                    enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                    enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                    enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                    enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                    enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                    enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                    experienceBlockDeviceDiscovery                        = $True
                    experienceBlockErrorDialogWhenNoSIM                   = $True
                    experienceBlockTaskSwitcher                           = $True
                    experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                    findMyFiles                                           = 'notConfigured'
                    gameDvrBlocked                                        = $True
                    id                                                    = 'FakeStringValue'
                    inkWorkspaceAccess                                    = 'notConfigured'
                    inkWorkspaceAccessState                               = 'notConfigured'
                    inkWorkspaceBlockSuggestedApps                        = $True
                    internetSharingBlocked                                = $True
                    locationServicesBlocked                               = $True
                    lockScreenActivateAppsWithVoice                       = 'notConfigured'
                    lockScreenAllowTimeoutConfiguration                   = $True
                    lockScreenBlockActionCenterNotifications              = $True
                    lockScreenBlockCortana                                = $True
                    lockScreenBlockToastNotifications                     = $True
                    lockScreenTimeoutInSeconds                            = 25
                    logonBlockFastUserSwitching                           = $True
                    messagingBlockMMS                                     = $True
                    messagingBlockRichCommunicationServices               = $True
                    messagingBlockSync                                    = $True
                    microsoftAccountBlocked                               = $True
                    microsoftAccountBlockSettingsSync                     = $True
                    microsoftAccountSignInAssistantSettings               = 'notConfigured'
                    networkProxyApplySettingsDeviceWide                   = $True
                    networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                    networkProxyDisableAutoDetect                         = $True
                    networkProxyServer                                    = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10NetworkProxyServer -Property @{
                            useForLocalAddresses = $True
                            exceptions           = @('FakeStringValue')
                            address              = 'FakeStringValue'
                        } -ClientOnly)
                    nfcBlocked                                            = $True
                    oneDriveDisableFileSync                               = $True
                    passwordBlockSimple                                   = $True
                    passwordExpirationDays                                = 25
                    passwordMinimumAgeInDays                              = 25
                    passwordMinimumCharacterSetCount                      = 25
                    passwordMinimumLength                                 = 25
                    passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                    passwordPreviousPasswordBlockCount                    = 25
                    passwordRequired                                      = $True
                    passwordRequiredType                                  = 'deviceDefault'
                    passwordRequireWhenResumeFromIdleState                = $True
                    passwordSignInFailureCountBeforeFactoryReset          = 25
                    personalizationDesktopImageUrl                        = 'FakeStringValue'
                    personalizationLockScreenImageUrl                     = 'FakeStringValue'
                    powerButtonActionOnBattery                            = 'notConfigured'
                    powerButtonActionPluggedIn                            = 'notConfigured'
                    powerHybridSleepOnBattery                             = 'notConfigured'
                    powerHybridSleepPluggedIn                             = 'notConfigured'
                    powerLidCloseActionOnBattery                          = 'notConfigured'
                    powerLidCloseActionPluggedIn                          = 'notConfigured'
                    powerSleepButtonActionOnBattery                       = 'notConfigured'
                    powerSleepButtonActionPluggedIn                       = 'notConfigured'
                    printerBlockAddition                                  = $True
                    printerDefaultName                                    = 'FakeStringValue'
                    printerNames                                          = @('FakeStringValue')
                    privacyAdvertisingId                                  = 'notConfigured'
                    privacyAutoAcceptPairingAndConsentPrompts             = $True
                    privacyBlockActivityFeed                              = $True
                    privacyBlockInputPersonalization                      = $True
                    privacyBlockPublishUserActivities                     = $True
                    privacyDisableLaunchExperience                        = $True
                    resetProtectionModeBlocked                            = $True
                    safeSearchFilter                                      = 'userDefined'
                    screenCaptureBlocked                                  = $True
                    searchBlockDiacritics                                 = $True
                    searchBlockWebResults                                 = $True
                    searchDisableAutoLanguageDetection                    = $True
                    searchDisableIndexerBackoff                           = $True
                    searchDisableIndexingEncryptedItems                   = $True
                    searchDisableIndexingRemovableDrive                   = $True
                    searchDisableLocation                                 = $True
                    searchDisableUseLocation                              = $True
                    searchEnableAutomaticIndexSizeManangement             = $True
                    searchEnableRemoteQueries                             = $True
                    securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                    settingsBlockAccountsPage                             = $True
                    settingsBlockAddProvisioningPackage                   = $True
                    settingsBlockAppsPage                                 = $True
                    settingsBlockChangeLanguage                           = $True
                    settingsBlockChangePowerSleep                         = $True
                    settingsBlockChangeRegion                             = $True
                    settingsBlockChangeSystemTime                         = $True
                    settingsBlockDevicesPage                              = $True
                    settingsBlockEaseOfAccessPage                         = $True
                    settingsBlockEditDeviceName                           = $True
                    settingsBlockGamingPage                               = $True
                    settingsBlockNetworkInternetPage                      = $True
                    settingsBlockPersonalizationPage                      = $True
                    settingsBlockPrivacyPage                              = $True
                    settingsBlockRemoveProvisioningPackage                = $True
                    settingsBlockSettingsApp                              = $True
                    settingsBlockSystemPage                               = $True
                    settingsBlockTimeLanguagePage                         = $True
                    settingsBlockUpdateSecurityPage                       = $True
                    sharedUserAppDataAllowed                              = $True
                    smartScreenAppInstallControl                          = 'notConfigured'
                    smartScreenBlockPromptOverride                        = $True
                    smartScreenBlockPromptOverrideForFiles                = $True
                    smartScreenEnableAppInstallControl                    = $True
                    startBlockUnpinningAppsFromTaskbar                    = $True
                    startMenuAppListVisibility                            = 'userDefined'
                    startMenuHideChangeAccountSettings                    = $True
                    startMenuHideFrequentlyUsedApps                       = $True
                    startMenuHideHibernate                                = $True
                    startMenuHideLock                                     = $True
                    startMenuHidePowerButton                              = $True
                    startMenuHideRecentJumpLists                          = $True
                    startMenuHideRecentlyAddedApps                        = $True
                    startMenuHideRestartOptions                           = $True
                    startMenuHideShutDown                                 = $True
                    startMenuHideSignOut                                  = $True
                    startMenuHideSleep                                    = $True
                    startMenuHideSwitchAccount                            = $True
                    startMenuHideUserTile                                 = $True
                    startMenuLayoutEdgeAssetsXml                          = $True
                    startMenuLayoutXml                                    = $True
                    startMenuMode                                         = 'userDefined'
                    startMenuPinnedFolderDocuments                        = 'notConfigured'
                    startMenuPinnedFolderDownloads                        = 'notConfigured'
                    startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                    startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                    startMenuPinnedFolderMusic                            = 'notConfigured'
                    startMenuPinnedFolderNetwork                          = 'notConfigured'
                    startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                    startMenuPinnedFolderPictures                         = 'notConfigured'
                    startMenuPinnedFolderSettings                         = 'notConfigured'
                    startMenuPinnedFolderVideos                           = 'notConfigured'
                    storageBlockRemovableStorage                          = $True
                    storageRequireMobileDeviceEncryption                  = $True
                    storageRestrictAppDataToSystemVolume                  = $True
                    storageRestrictAppInstallToSystemVolume               = $True
                    supportsScopeTags                                     = $True
                    systemTelemetryProxyServer                            = 'FakeStringValue'
                    taskManagerBlockEndTask                               = $True
                    tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                    uninstallBuiltInApps                                  = $True
                    usbBlocked                                            = $True
                    voiceRecordingBlocked                                 = $True
                    webRtcBlockLocalhostIpAddress                         = $True
                    wiFiBlockAutomaticConnectHotspots                     = $True
                    wiFiBlocked                                           = $True
                    wiFiBlockManualConfiguration                          = $True
                    wiFiScanInterval                                      = 25
                    windows10AppsForceUpdateSchedule                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10AppsForceUpdateSchedule -Property @{
                            runImmediatelyIfAfterStartDateTime = $True
                            recurrence                         = 'none'
                            startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                        } -ClientOnly)
                    windowsSpotlightBlockConsumerSpecificFeatures         = $True
                    windowsSpotlightBlocked                               = $True
                    windowsSpotlightBlockOnActionCenter                   = $True
                    windowsSpotlightBlockTailoredExperiences              = $True
                    windowsSpotlightBlockThirdPartyNotifications          = $True
                    windowsSpotlightBlockWelcomeExperience                = $True
                    windowsSpotlightBlockWindowsTips                      = $True
                    windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                    windowsStoreBlockAutoUpdate                           = $True
                    windowsStoreBlocked                                   = $True
                    windowsStoreEnablePrivateStoreOnly                    = $True
                    wirelessDisplayBlockProjectionToThisDevice            = $True
                    wirelessDisplayBlockUserInputFromReceiver             = $True
                    wirelessDisplayRequirePinForPairing                   = $True
                    Ensure                                                = 'Present'
                    Credential                                            = $Credential
                }

                Mock -CommandName Get-MgBetaDeviceManagementDeviceConfiguration -MockWith {
                    return $null
                }
            }
            It 'Should return Values from the Get method' {
                (Get-TargetResource @testParams).Ensure | Should -Be 'Absent'
            }
            It 'Should return false from the Test method' {
                Test-TargetResource @testParams | Should -Be $false
            }
            It 'Should Create the group from the Set method' {
                Set-TargetResource @testParams
                Should -Invoke -CommandName 'New-MgBetaDeviceManagementDeviceConfiguration' -Exactly 1
            }
        }

        Context -Name 'The IntuneDeviceConfigurationPolicyWindows10 exists but it SHOULD NOT' -Fixture {
            BeforeAll {
                $testParams = @{
                    AccountsBlockAddingNonMicrosoftAccountEmail           = $True
                    ActivateAppsWithVoice                                 = 'notConfigured'
                    AntiTheftModeBlocked                                  = $True
                    AppManagementMSIAllowUserControlOverInstall           = $True
                    AppManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                    AppManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                    AppsAllowTrustedAppsSideloading                       = 'notConfigured'
                    AppsBlockWindowsStoreOriginatedApps                   = $True
                    AuthenticationAllowSecondaryDevice                    = $True
                    AuthenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                    AuthenticationWebSignIn                               = 'notConfigured'
                    BluetoothAllowedServices                              = @('FakeStringValue')
                    BluetoothBlockAdvertising                             = $True
                    BluetoothBlockDiscoverableMode                        = $True
                    BluetoothBlocked                                      = $True
                    BluetoothBlockPrePairing                              = $True
                    BluetoothBlockPromptedProximalConnections             = $True
                    CameraBlocked                                         = $True
                    CellularBlockDataWhenRoaming                          = $True
                    CellularBlockVpn                                      = $True
                    CellularBlockVpnWhenRoaming                           = $True
                    CellularData                                          = 'blocked'
                    CertificatesBlockManualRootCertificateInstallation    = $True
                    ConfigureTimeZone                                     = 'FakeStringValue'
                    ConnectedDevicesServiceBlocked                        = $True
                    CopyPasteBlocked                                      = $True
                    CortanaBlocked                                        = $True
                    CryptographyAllowFipsAlgorithmPolicy                  = $True
                    DataProtectionBlockDirectMemoryAccess                 = $True
                    DefenderBlockEndUserAccess                            = $True
                    DefenderBlockOnAccessProtection                       = $True
                    DefenderCloudBlockLevel                               = 'notConfigured'
                    DefenderCloudExtendedTimeout                          = 25
                    DefenderCloudExtendedTimeoutInSeconds                 = 25
                    DefenderDaysBeforeDeletingQuarantinedMalware          = 25
                    defenderDetectedMalwareActions                        = (New-CimInstance -ClassName MSFT_MicrosoftGraphdefenderDetectedMalwareActions1 -Property @{
                            lowSeverity      = 'deviceDefault'
                            severeSeverity   = 'deviceDefault'
                            moderateSeverity = 'deviceDefault'
                            highSeverity     = 'deviceDefault'
                        } -ClientOnly)
                    defenderDisableCatchupFullScan                        = $True
                    defenderDisableCatchupQuickScan                       = $True
                    defenderFileExtensionsToExclude                       = @('FakeStringValue')
                    defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                    defenderMonitorFileActivity                           = 'userDefined'
                    defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                    defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                    defenderProcessesToExclude                            = @('FakeStringValue')
                    defenderPromptForSampleSubmission                     = 'userDefined'
                    defenderRequireBehaviorMonitoring                     = $True
                    defenderRequireCloudProtection                        = $True
                    defenderRequireNetworkInspectionSystem                = $True
                    defenderRequireRealTimeMonitoring                     = $True
                    defenderScanArchiveFiles                              = $True
                    defenderScanDownloads                                 = $True
                    defenderScanIncomingMail                              = $True
                    defenderScanMappedNetworkDrivesDuringFullScan         = $True
                    defenderScanMaxCpu                                    = 25
                    defenderScanNetworkFiles                              = $True
                    defenderScanRemovableDrivesDuringFullScan             = $True
                    defenderScanScriptsLoadedInInternetExplorer           = $True
                    defenderScanType                                      = 'userDefined'
                    defenderScheduledQuickScanTime                        = '00:00:00'
                    defenderScheduledScanTime                             = '00:00:00'
                    defenderScheduleScanEnableLowCpuPriority              = $True
                    defenderSignatureUpdateIntervalInHours                = 25
                    defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                    defenderSystemScanSchedule                            = 'userDefined'
                    description                                           = 'FakeStringValue'
                    developerUnlockSetting                                = 'notConfigured'
                    deviceManagementBlockFactoryResetOnMobile             = $True
                    deviceManagementBlockManualUnenroll                   = $True
                    diagnosticsDataSubmissionMode                         = 'userDefined'
                    displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                    displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                    displayName                                           = 'FakeStringValue'
                    edgeAllowStartPagesModification                       = $True
                    edgeBlockAccessToAboutFlags                           = $True
                    edgeBlockAddressBarDropdown                           = $True
                    edgeBlockAutofill                                     = $True
                    edgeBlockCompatibilityList                            = $True
                    edgeBlockDeveloperTools                               = $True
                    edgeBlocked                                           = $True
                    edgeBlockEditFavorites                                = $True
                    edgeBlockExtensions                                   = $True
                    edgeBlockFullScreenMode                               = $True
                    edgeBlockInPrivateBrowsing                            = $True
                    edgeBlockJavaScript                                   = $True
                    edgeBlockLiveTileDataCollection                       = $True
                    edgeBlockPasswordManager                              = $True
                    edgeBlockPopups                                       = $True
                    edgeBlockPrelaunch                                    = $True
                    edgeBlockPrinting                                     = $True
                    edgeBlockSavingHistory                                = $True
                    edgeBlockSearchEngineCustomization                    = $True
                    edgeBlockSearchSuggestions                            = $True
                    edgeBlockSendingDoNotTrackHeader                      = $True
                    edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                    edgeBlockSideloadingExtensions                        = $True
                    edgeBlockTabPreloading                                = $True
                    edgeBlockWebContentOnNewTabPage                       = $True
                    edgeClearBrowsingDataOnExit                           = $True
                    edgeCookiePolicy                                      = 'userDefined'
                    edgeDisableFirstRunPage                               = $True
                    edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                    edgeFavoritesBarVisibility                            = 'notConfigured'
                    edgeFavoritesListLocation                             = 'FakeStringValue'
                    edgeFirstRunUrl                                       = 'FakeStringValue'
                    edgeHomeButtonConfiguration                           = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeHomeButtonConfiguration -Property @{
                            odataType           = '#microsoft.graph.edgeHomeButtonHidden'
                            homeButtonCustomURL = 'FakeStringValue'
                        } -ClientOnly)
                    edgeHomeButtonConfigurationEnabled                    = $True
                    edgeHomepageUrls                                      = @('FakeStringValue')
                    edgeKioskModeRestriction                              = 'notConfigured'
                    edgeKioskResetAfterIdleTimeInMinutes                  = 25
                    edgeNewTabPageURL                                     = 'FakeStringValue'
                    edgeOpensWith                                         = 'notConfigured'
                    edgePreventCertificateErrorOverride                   = $True
                    edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                    edgeRequireSmartScreen                                = $True
                    edgeSearchEngine                                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeSearchEngineBase -Property @{
                            edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                            edgeSearchEngineType             = 'default'
                            odataType                        = '#microsoft.graph.edgeSearchEngine'
                        } -ClientOnly)
                    edgeSendIntranetTrafficToInternetExplorer             = $True
                    edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                    edgeSyncFavoritesWithInternetExplorer                 = $True
                    edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                    enableAutomaticRedeployment                           = $True
                    energySaverOnBatteryThresholdPercentage               = 25
                    energySaverPluggedInThresholdPercentage               = 25
                    enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                    enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                    enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                    enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                    enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                    enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                    experienceBlockDeviceDiscovery                        = $True
                    experienceBlockErrorDialogWhenNoSIM                   = $True
                    experienceBlockTaskSwitcher                           = $True
                    experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                    findMyFiles                                           = 'notConfigured'
                    gameDvrBlocked                                        = $True
                    id                                                    = 'FakeStringValue'
                    inkWorkspaceAccess                                    = 'notConfigured'
                    inkWorkspaceAccessState                               = 'notConfigured'
                    inkWorkspaceBlockSuggestedApps                        = $True
                    internetSharingBlocked                                = $True
                    locationServicesBlocked                               = $True
                    lockScreenActivateAppsWithVoice                       = 'notConfigured'
                    lockScreenAllowTimeoutConfiguration                   = $True
                    lockScreenBlockActionCenterNotifications              = $True
                    lockScreenBlockCortana                                = $True
                    lockScreenBlockToastNotifications                     = $True
                    lockScreenTimeoutInSeconds                            = 25
                    logonBlockFastUserSwitching                           = $True
                    messagingBlockMMS                                     = $True
                    messagingBlockRichCommunicationServices               = $True
                    messagingBlockSync                                    = $True
                    microsoftAccountBlocked                               = $True
                    microsoftAccountBlockSettingsSync                     = $True
                    microsoftAccountSignInAssistantSettings               = 'notConfigured'
                    networkProxyApplySettingsDeviceWide                   = $True
                    networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                    networkProxyDisableAutoDetect                         = $True
                    networkProxyServer                                    = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10NetworkProxyServer -Property @{
                            useForLocalAddresses = $True
                            exceptions           = @('FakeStringValue')
                            address              = 'FakeStringValue'
                        } -ClientOnly)
                    nfcBlocked                                            = $True
                    oneDriveDisableFileSync                               = $True
                    passwordBlockSimple                                   = $True
                    passwordExpirationDays                                = 25
                    passwordMinimumAgeInDays                              = 25
                    passwordMinimumCharacterSetCount                      = 25
                    passwordMinimumLength                                 = 25
                    passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                    passwordPreviousPasswordBlockCount                    = 25
                    passwordRequired                                      = $True
                    passwordRequiredType                                  = 'deviceDefault'
                    passwordRequireWhenResumeFromIdleState                = $True
                    passwordSignInFailureCountBeforeFactoryReset          = 25
                    personalizationDesktopImageUrl                        = 'FakeStringValue'
                    personalizationLockScreenImageUrl                     = 'FakeStringValue'
                    powerButtonActionOnBattery                            = 'notConfigured'
                    powerButtonActionPluggedIn                            = 'notConfigured'
                    powerHybridSleepOnBattery                             = 'notConfigured'
                    powerHybridSleepPluggedIn                             = 'notConfigured'
                    powerLidCloseActionOnBattery                          = 'notConfigured'
                    powerLidCloseActionPluggedIn                          = 'notConfigured'
                    powerSleepButtonActionOnBattery                       = 'notConfigured'
                    powerSleepButtonActionPluggedIn                       = 'notConfigured'
                    printerBlockAddition                                  = $True
                    printerDefaultName                                    = 'FakeStringValue'
                    printerNames                                          = @('FakeStringValue')
                    privacyAdvertisingId                                  = 'notConfigured'
                    privacyAutoAcceptPairingAndConsentPrompts             = $True
                    privacyBlockActivityFeed                              = $True
                    privacyBlockInputPersonalization                      = $True
                    privacyBlockPublishUserActivities                     = $True
                    privacyDisableLaunchExperience                        = $True
                    resetProtectionModeBlocked                            = $True
                    safeSearchFilter                                      = 'userDefined'
                    screenCaptureBlocked                                  = $True
                    searchBlockDiacritics                                 = $True
                    searchBlockWebResults                                 = $True
                    searchDisableAutoLanguageDetection                    = $True
                    searchDisableIndexerBackoff                           = $True
                    searchDisableIndexingEncryptedItems                   = $True
                    searchDisableIndexingRemovableDrive                   = $True
                    searchDisableLocation                                 = $True
                    searchDisableUseLocation                              = $True
                    searchEnableAutomaticIndexSizeManangement             = $True
                    searchEnableRemoteQueries                             = $True
                    securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                    settingsBlockAccountsPage                             = $True
                    settingsBlockAddProvisioningPackage                   = $True
                    settingsBlockAppsPage                                 = $True
                    settingsBlockChangeLanguage                           = $True
                    settingsBlockChangePowerSleep                         = $True
                    settingsBlockChangeRegion                             = $True
                    settingsBlockChangeSystemTime                         = $True
                    settingsBlockDevicesPage                              = $True
                    settingsBlockEaseOfAccessPage                         = $True
                    settingsBlockEditDeviceName                           = $True
                    settingsBlockGamingPage                               = $True
                    settingsBlockNetworkInternetPage                      = $True
                    settingsBlockPersonalizationPage                      = $True
                    settingsBlockPrivacyPage                              = $True
                    settingsBlockRemoveProvisioningPackage                = $True
                    settingsBlockSettingsApp                              = $True
                    settingsBlockSystemPage                               = $True
                    settingsBlockTimeLanguagePage                         = $True
                    settingsBlockUpdateSecurityPage                       = $True
                    sharedUserAppDataAllowed                              = $True
                    smartScreenAppInstallControl                          = 'notConfigured'
                    smartScreenBlockPromptOverride                        = $True
                    smartScreenBlockPromptOverrideForFiles                = $True
                    smartScreenEnableAppInstallControl                    = $True
                    startBlockUnpinningAppsFromTaskbar                    = $True
                    startMenuAppListVisibility                            = 'userDefined'
                    startMenuHideChangeAccountSettings                    = $True
                    startMenuHideFrequentlyUsedApps                       = $True
                    startMenuHideHibernate                                = $True
                    startMenuHideLock                                     = $True
                    startMenuHidePowerButton                              = $True
                    startMenuHideRecentJumpLists                          = $True
                    startMenuHideRecentlyAddedApps                        = $True
                    startMenuHideRestartOptions                           = $True
                    startMenuHideShutDown                                 = $True
                    startMenuHideSignOut                                  = $True
                    startMenuHideSleep                                    = $True
                    startMenuHideSwitchAccount                            = $True
                    startMenuHideUserTile                                 = $True
                    startMenuLayoutEdgeAssetsXml                          = $True
                    startMenuLayoutXml                                    = $True
                    startMenuMode                                         = 'userDefined'
                    startMenuPinnedFolderDocuments                        = 'notConfigured'
                    startMenuPinnedFolderDownloads                        = 'notConfigured'
                    startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                    startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                    startMenuPinnedFolderMusic                            = 'notConfigured'
                    startMenuPinnedFolderNetwork                          = 'notConfigured'
                    startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                    startMenuPinnedFolderPictures                         = 'notConfigured'
                    startMenuPinnedFolderSettings                         = 'notConfigured'
                    startMenuPinnedFolderVideos                           = 'notConfigured'
                    storageBlockRemovableStorage                          = $True
                    storageRequireMobileDeviceEncryption                  = $True
                    storageRestrictAppDataToSystemVolume                  = $True
                    storageRestrictAppInstallToSystemVolume               = $True
                    supportsScopeTags                                     = $True
                    systemTelemetryProxyServer                            = 'FakeStringValue'
                    taskManagerBlockEndTask                               = $True
                    tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                    uninstallBuiltInApps                                  = $True
                    usbBlocked                                            = $True
                    voiceRecordingBlocked                                 = $True
                    webRtcBlockLocalhostIpAddress                         = $True
                    wiFiBlockAutomaticConnectHotspots                     = $True
                    wiFiBlocked                                           = $True
                    wiFiBlockManualConfiguration                          = $True
                    wiFiScanInterval                                      = 25
                    windows10AppsForceUpdateSchedule                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10AppsForceUpdateSchedule -Property @{
                            runImmediatelyIfAfterStartDateTime = $True
                            recurrence                         = 'none'
                            startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                        } -ClientOnly)
                    windowsSpotlightBlockConsumerSpecificFeatures         = $True
                    windowsSpotlightBlocked                               = $True
                    windowsSpotlightBlockOnActionCenter                   = $True
                    windowsSpotlightBlockTailoredExperiences              = $True
                    windowsSpotlightBlockThirdPartyNotifications          = $True
                    windowsSpotlightBlockWelcomeExperience                = $True
                    windowsSpotlightBlockWindowsTips                      = $True
                    windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                    windowsStoreBlockAutoUpdate                           = $True
                    windowsStoreBlocked                                   = $True
                    windowsStoreEnablePrivateStoreOnly                    = $True
                    wirelessDisplayBlockProjectionToThisDevice            = $True
                    wirelessDisplayBlockUserInputFromReceiver             = $True
                    wirelessDisplayRequirePinForPairing                   = $True
                    Ensure                                                = 'Absent'
                    Credential                                            = $Credential
                }

                Mock -CommandName Get-MgBetaDeviceManagementDeviceConfiguration -MockWith {
                    return @{
                        AdditionalProperties = @{
                            enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                            startMenuHideSwitchAccount                            = $True
                            defenderBlockEndUserAccess                            = $True
                            searchEnableAutomaticIndexSizeManangement             = $True
                            defenderRequireNetworkInspectionSystem                = $True
                            settingsBlockGamingPage                               = $True
                            smartScreenBlockPromptOverrideForFiles                = $True
                            passwordBlockSimple                                   = $True
                            powerLidCloseActionPluggedIn                          = 'notConfigured'
                            defenderRequireCloudProtection                        = $True
                            defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                            resetProtectionModeBlocked                            = $True
                            startBlockUnpinningAppsFromTaskbar                    = $True
                            networkProxyApplySettingsDeviceWide                   = $True
                            bluetoothAllowedServices                              = @('FakeStringValue')
                            defenderScanArchiveFiles                              = $True
                            lockScreenActivateAppsWithVoice                       = 'notConfigured'
                            defenderScanIncomingMail                              = $True
                            edgeBlockAutofill                                     = $True
                            authenticationAllowSecondaryDevice                    = $True
                            edgeRequireSmartScreen                                = $True
                            windowsSpotlightBlockOnActionCenter                   = $True
                            usbBlocked                                            = $True
                            enableAutomaticRedeployment                           = $True
                            microsoftAccountSignInAssistantSettings               = 'notConfigured'
                            deviceManagementBlockFactoryResetOnMobile             = $True
                            defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                            powerButtonActionOnBattery                            = 'notConfigured'
                            startMenuAppListVisibility                            = 'userDefined'
                            lockScreenBlockCortana                                = $True
                            windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                            startMenuPinnedFolderPictures                         = 'notConfigured'
                            screenCaptureBlocked                                  = $True
                            webRtcBlockLocalhostIpAddress                         = $True
                            safeSearchFilter                                      = 'userDefined'
                            searchDisableLocation                                 = $True
                            edgeBlockInPrivateBrowsing                            = $True
                            appManagementMSIAllowUserControlOverInstall           = $True
                            defenderSignatureUpdateIntervalInHours                = 25
                            startMenuHideSleep                                    = $True
                            voiceRecordingBlocked                                 = $True
                            edgeFavoritesListLocation                             = 'FakeStringValue'
                            startMenuHideLock                                     = $True
                            wiFiBlockManualConfiguration                          = $True
                            edgeBlockTabPreloading                                = $True
                            configureTimeZone                                     = 'FakeStringValue'
                            edgeBlocked                                           = $True
                            taskManagerBlockEndTask                               = $True
                            settingsBlockAppsPage                                 = $True
                            settingsBlockChangePowerSleep                         = $True
                            copyPasteBlocked                                      = $True
                            settingsBlockNetworkInternetPage                      = $True
                            privacyBlockInputPersonalization                      = $True
                            appManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                            powerLidCloseActionOnBattery                          = 'notConfigured'
                            searchDisableIndexerBackoff                           = $True
                            edgeBlockFullScreenMode                               = $True
                            lockScreenTimeoutInSeconds                            = 25
                            developerUnlockSetting                                = 'notConfigured'
                            storageRestrictAppDataToSystemVolume                  = $True
                            cellularBlockVpn                                      = $True
                            powerHybridSleepPluggedIn                             = 'notConfigured'
                            settingsBlockChangeLanguage                           = $True
                            powerSleepButtonActionOnBattery                       = 'notConfigured'
                            antiTheftModeBlocked                                  = $True
                            defenderMonitorFileActivity                           = 'userDefined'
                            defenderFileExtensionsToExclude                       = @('FakeStringValue')
                            bluetoothBlockDiscoverableMode                        = $True
                            enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                            diagnosticsDataSubmissionMode                         = 'userDefined'
                            uninstallBuiltInApps                                  = $True
                            oneDriveDisableFileSync                               = $True
                            startMenuHideUserTile                                 = $True
                            startMenuHideSignOut                                  = $True
                            defenderDaysBeforeDeletingQuarantinedMalware          = 25
                            privacyAutoAcceptPairingAndConsentPrompts             = $True
                            settingsBlockChangeRegion                             = $True
                            passwordMinimumAgeInDays                              = 25
                            powerHybridSleepOnBattery                             = 'notConfigured'
                            displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                            edgeBlockSearchSuggestions                            = $True
                            settingsBlockSystemPage                               = $True
                            defenderRequireBehaviorMonitoring                     = $True
                            microsoftAccountBlockSettingsSync                     = $True
                            windowsSpotlightBlockWindowsTips                      = $True
                            startMenuHideRecentlyAddedApps                        = $True
                            inkWorkspaceBlockSuggestedApps                        = $True
                            personalizationDesktopImageUrl                        = 'FakeStringValue'
                            edgeHomeButtonConfigurationEnabled                    = $True
                            passwordRequiredType                                  = 'deviceDefault'
                            startMenuPinnedFolderSettings                         = 'notConfigured'
                            connectedDevicesServiceBlocked                        = $True
                            edgeBlockExtensions                                   = $True
                            edgeBlockAddressBarDropdown                           = $True
                            findMyFiles                                           = 'notConfigured'
                            privacyBlockPublishUserActivities                     = $True
                            startMenuHideFrequentlyUsedApps                       = $True
                            '@odata.type'                                         = '#microsoft.graph.windows10GeneralConfiguration'
                            powerSleepButtonActionPluggedIn                       = 'notConfigured'
                            internetSharingBlocked                                = $True
                            startMenuHidePowerButton                              = $True
                            networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                            personalizationLockScreenImageUrl                     = 'FakeStringValue'
                            bluetoothBlockPrePairing                              = $True
                            windowsSpotlightBlockWelcomeExperience                = $True
                            startMenuHideShutDown                                 = $True
                            storageRestrictAppInstallToSystemVolume               = $True
                            windowsSpotlightBlockThirdPartyNotifications          = $True
                            searchDisableAutoLanguageDetection                    = $True
                            edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                            appsAllowTrustedAppsSideloading                       = 'notConfigured'
                            edgeBlockLiveTileDataCollection                       = $True
                            wirelessDisplayBlockProjectionToThisDevice            = $True
                            startMenuHideRestartOptions                           = $True
                            edgeSendIntranetTrafficToInternetExplorer             = $True
                            startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                            edgeBlockWebContentOnNewTabPage                       = $True
                            startMenuLayoutXml                                    = $True
                            searchBlockDiacritics                                 = $True
                            storageBlockRemovableStorage                          = $True
                            enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                            wirelessDisplayRequirePinForPairing                   = $True
                            defenderScheduledQuickScanTime                        = '00:00:00'
                            edgeAllowStartPagesModification                       = $True
                            defenderRequireRealTimeMonitoring                     = $True
                            authenticationWebSignIn                               = 'notConfigured'
                            lockScreenBlockToastNotifications                     = $True
                            energySaverPluggedInThresholdPercentage               = 25
                            defenderScanMappedNetworkDrivesDuringFullScan         = $True
                            smartScreenBlockPromptOverride                        = $True
                            edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                            authenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                            defenderScanType                                      = 'userDefined'
                            bluetoothBlockAdvertising                             = $True
                            enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                            logonBlockFastUserSwitching                           = $True
                            networkProxyDisableAutoDetect                         = $True
                            cameraBlocked                                         = $True
                            wiFiScanInterval                                      = 25
                            edgeBlockSideloadingExtensions                        = $True
                            settingsBlockEaseOfAccessPage                         = $True
                            microsoftAccountBlocked                               = $True
                            defenderScanRemovableDrivesDuringFullScan             = $True
                            energySaverOnBatteryThresholdPercentage               = 25
                            startMenuHideHibernate                                = $True
                            defenderScanDownloads                                 = $True
                            defenderBlockOnAccessProtection                       = $True
                            defenderCloudBlockLevel                               = 'notConfigured'
                            storageRequireMobileDeviceEncryption                  = $True
                            windowsStoreEnablePrivateStoreOnly                    = $True
                            edgeBlockCompatibilityList                            = $True
                            wiFiBlockAutomaticConnectHotspots                     = $True
                            defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                            defenderCloudExtendedTimeout                          = 25
                            edgeHomepageUrls                                      = @('FakeStringValue')
                            cellularBlockDataWhenRoaming                          = $True
                            securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                            smartScreenAppInstallControl                          = 'notConfigured'
                            enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                            bluetoothBlockPromptedProximalConnections             = $True
                            settingsBlockPrivacyPage                              = $True
                            windowsSpotlightBlocked                               = $True
                            tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                            startMenuPinnedFolderDocuments                        = 'notConfigured'
                            systemTelemetryProxyServer                            = 'FakeStringValue'
                            lockScreenAllowTimeoutConfiguration                   = $True
                            defenderSystemScanSchedule                            = 'userDefined'
                            windowsSpotlightBlockConsumerSpecificFeatures         = $True
                            searchDisableUseLocation                              = $True
                            appsBlockWindowsStoreOriginatedApps                   = $True
                            startMenuPinnedFolderNetwork                          = 'notConfigured'
                            edgeBlockPrinting                                     = $True
                            settingsBlockEditDeviceName                           = $True
                            printerNames                                          = @('FakeStringValue')
                            settingsBlockUpdateSecurityPage                       = $True
                            startMenuMode                                         = 'userDefined'
                            searchBlockWebResults                                 = $True
                            edgePreventCertificateErrorOverride                   = $True
                            passwordRequired                                      = $True
                            defenderScanNetworkFiles                              = $True
                            startMenuPinnedFolderMusic                            = 'notConfigured'
                            cortanaBlocked                                        = $True
                            searchEnableRemoteQueries                             = $True
                            messagingBlockSync                                    = $True
                            startMenuPinnedFolderVideos                           = 'notConfigured'
                            enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                            experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                            edgeDisableFirstRunPage                               = $True
                            edgeCookiePolicy                                      = 'userDefined'
                            inkWorkspaceAccessState                               = 'notConfigured'
                            windows10AppsForceUpdateSchedule                      = @{
                                runImmediatelyIfAfterStartDateTime = $True
                                recurrence                         = 'none'
                                startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                            }
                            dataProtectionBlockDirectMemoryAccess                 = $True
                            experienceBlockErrorDialogWhenNoSIM                   = $True
                            settingsBlockPersonalizationPage                      = $True
                            wirelessDisplayBlockUserInputFromReceiver             = $True
                            startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                            activateAppsWithVoice                                 = 'notConfigured'
                            edgeClearBrowsingDataOnExit                           = $True
                            passwordPreviousPasswordBlockCount                    = 25
                            edgeBlockSearchEngineCustomization                    = $True
                            deviceManagementBlockManualUnenroll                   = $True
                            edgeBlockSavingHistory                                = $True
                            inkWorkspaceAccess                                    = 'notConfigured'
                            startMenuHideRecentJumpLists                          = $True
                            privacyBlockActivityFeed                              = $True
                            settingsBlockChangeSystemTime                         = $True
                            defenderDisableCatchupQuickScan                       = $True
                            smartScreenEnableAppInstallControl                    = $True
                            edgeBlockDeveloperTools                               = $True
                            edgeKioskModeRestriction                              = 'notConfigured'
                            lockScreenBlockActionCenterNotifications              = $True
                            privacyAdvertisingId                                  = 'notConfigured'
                            settingsBlockSettingsApp                              = $True
                            settingsBlockAccountsPage                             = $True
                            certificatesBlockManualRootCertificateInstallation    = $True
                            edgeBlockJavaScript                                   = $True
                            edgeSyncFavoritesWithInternetExplorer                 = $True
                            startMenuLayoutEdgeAssetsXml                          = $True
                            windowsSpotlightBlockTailoredExperiences              = $True
                            defenderPromptForSampleSubmission                     = 'userDefined'
                            edgeBlockAccessToAboutFlags                           = $True
                            messagingBlockMMS                                     = $True
                            edgeBlockEditFavorites                                = $True
                            printerDefaultName                                    = 'FakeStringValue'
                            experienceBlockDeviceDiscovery                        = $True
                            privacyDisableLaunchExperience                        = $True
                            edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                            nfcBlocked                                            = $True
                            searchDisableIndexingRemovableDrive                   = $True
                            powerButtonActionPluggedIn                            = 'notConfigured'
                            settingsBlockRemoveProvisioningPackage                = $True
                            edgeKioskResetAfterIdleTimeInMinutes                  = 25
                            passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                            printerBlockAddition                                  = $True
                            defenderScanScriptsLoadedInInternetExplorer           = $True
                            defenderDisableCatchupFullScan                        = $True
                            edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                            bluetoothBlocked                                      = $True
                            settingsBlockAddProvisioningPackage                   = $True
                            passwordMinimumLength                                 = 25
                            startMenuHideChangeAccountSettings                    = $True
                            defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                            edgeBlockPopups                                       = $True
                            networkProxyServer                                    = @{
                                useForLocalAddresses = $True
                                exceptions           = @('FakeStringValue')
                                address              = 'FakeStringValue'
                            }
                            startMenuPinnedFolderDownloads                        = 'notConfigured'
                            settingsBlockDevicesPage                              = $True
                            wiFiBlocked                                           = $True
                            windowsStoreBlocked                                   = $True
                            edgeBlockPrelaunch                                    = $True
                            gameDvrBlocked                                        = $True
                            experienceBlockTaskSwitcher                           = $True
                            edgeBlockPasswordManager                              = $True
                            passwordSignInFailureCountBeforeFactoryReset          = 25
                            passwordMinimumCharacterSetCount                      = 25
                            searchDisableIndexingEncryptedItems                   = $True
                            appManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                            cellularData                                          = 'blocked'
                            defenderScheduledScanTime                             = '00:00:00'
                            edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                            defenderProcessesToExclude                            = @('FakeStringValue')
                            defenderDetectedMalwareActions                        = @{
                                lowSeverity      = 'deviceDefault'
                                severeSeverity   = 'deviceDefault'
                                moderateSeverity = 'deviceDefault'
                                highSeverity     = 'deviceDefault'
                            }
                            edgeHomeButtonConfiguration                           = @{
                                homeButtonCustomURL = 'FakeStringValue'
                                '@odata.type'       = '#microsoft.graph.edgeHomeButtonHidden'
                            }
                            cryptographyAllowFipsAlgorithmPolicy                  = $True
                            sharedUserAppDataAllowed                              = $True
                            edgeFirstRunUrl                                       = 'FakeStringValue'
                            edgeBlockSendingDoNotTrackHeader                      = $True
                            edgeOpensWith                                         = 'notConfigured'
                            defenderScheduleScanEnableLowCpuPriority              = $True
                            windowsStoreBlockAutoUpdate                           = $True
                            messagingBlockRichCommunicationServices               = $True
                            edgeNewTabPageURL                                     = 'FakeStringValue'
                            passwordRequireWhenResumeFromIdleState                = $True
                            passwordExpirationDays                                = 25
                            displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                            settingsBlockTimeLanguagePage                         = $True
                            locationServicesBlocked                               = $True
                            defenderScanMaxCpu                                    = 25
                            edgeFavoritesBarVisibility                            = 'notConfigured'
                            accountsBlockAddingNonMicrosoftAccountEmail           = $True
                            defenderCloudExtendedTimeoutInSeconds                 = 25
                            cellularBlockVpnWhenRoaming                           = $True
                            startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                            edgeSearchEngine                                      = @{
                                edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                                edgeSearchEngineType             = 'default'
                                '@odata.type'                    = '#microsoft.graph.edgeSearchEngine'
                            }
                        }
                        description          = 'FakeStringValue'
                        displayName          = 'FakeStringValue'
                        id                   = 'FakeStringValue'
                        supportsScopeTags    = $True

                    }
                }
            }

            It 'Should return Values from the Get method' {
                (Get-TargetResource @testParams).Ensure | Should -Be 'Present'
            }

            It 'Should return true from the Test method' {
                Test-TargetResource @testParams | Should -Be $false
            }

            It 'Should Remove the group from the Set method' {
                Set-TargetResource @testParams
                Should -Invoke -CommandName Remove-MgBetaDeviceManagementDeviceConfiguration -Exactly 1
            }
        }
        Context -Name 'The IntuneDeviceConfigurationPolicyWindows10 Exists and Values are already in the desired state' -Fixture {
            BeforeAll {
                $testParams = @{
                    AccountsBlockAddingNonMicrosoftAccountEmail           = $True
                    ActivateAppsWithVoice                                 = 'notConfigured'
                    AntiTheftModeBlocked                                  = $True
                    AppManagementMSIAllowUserControlOverInstall           = $True
                    AppManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                    AppManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                    AppsAllowTrustedAppsSideloading                       = 'notConfigured'
                    AppsBlockWindowsStoreOriginatedApps                   = $True
                    AuthenticationAllowSecondaryDevice                    = $True
                    AuthenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                    AuthenticationWebSignIn                               = 'notConfigured'
                    BluetoothAllowedServices                              = @('FakeStringValue')
                    BluetoothBlockAdvertising                             = $True
                    BluetoothBlockDiscoverableMode                        = $True
                    BluetoothBlocked                                      = $True
                    BluetoothBlockPrePairing                              = $True
                    BluetoothBlockPromptedProximalConnections             = $True
                    CameraBlocked                                         = $True
                    CellularBlockDataWhenRoaming                          = $True
                    CellularBlockVpn                                      = $True
                    CellularBlockVpnWhenRoaming                           = $True
                    CellularData                                          = 'blocked'
                    CertificatesBlockManualRootCertificateInstallation    = $True
                    ConfigureTimeZone                                     = 'FakeStringValue'
                    ConnectedDevicesServiceBlocked                        = $True
                    CopyPasteBlocked                                      = $True
                    CortanaBlocked                                        = $True
                    CryptographyAllowFipsAlgorithmPolicy                  = $True
                    DataProtectionBlockDirectMemoryAccess                 = $True
                    DefenderBlockEndUserAccess                            = $True
                    DefenderBlockOnAccessProtection                       = $True
                    DefenderCloudBlockLevel                               = 'notConfigured'
                    DefenderCloudExtendedTimeout                          = 25
                    DefenderCloudExtendedTimeoutInSeconds                 = 25
                    DefenderDaysBeforeDeletingQuarantinedMalware          = 25
                    defenderDetectedMalwareActions                        = (New-CimInstance -ClassName MSFT_MicrosoftGraphdefenderDetectedMalwareActions1 -Property @{
                            lowSeverity      = 'deviceDefault'
                            severeSeverity   = 'deviceDefault'
                            moderateSeverity = 'deviceDefault'
                            highSeverity     = 'deviceDefault'
                        } -ClientOnly)
                    defenderDisableCatchupFullScan                        = $True
                    defenderDisableCatchupQuickScan                       = $True
                    defenderFileExtensionsToExclude                       = @('FakeStringValue')
                    defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                    defenderMonitorFileActivity                           = 'userDefined'
                    defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                    defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                    defenderProcessesToExclude                            = @('FakeStringValue')
                    defenderPromptForSampleSubmission                     = 'userDefined'
                    defenderRequireBehaviorMonitoring                     = $True
                    defenderRequireCloudProtection                        = $True
                    defenderRequireNetworkInspectionSystem                = $True
                    defenderRequireRealTimeMonitoring                     = $True
                    defenderScanArchiveFiles                              = $True
                    defenderScanDownloads                                 = $True
                    defenderScanIncomingMail                              = $True
                    defenderScanMappedNetworkDrivesDuringFullScan         = $True
                    defenderScanMaxCpu                                    = 25
                    defenderScanNetworkFiles                              = $True
                    defenderScanRemovableDrivesDuringFullScan             = $True
                    defenderScanScriptsLoadedInInternetExplorer           = $True
                    defenderScanType                                      = 'userDefined'
                    defenderScheduledQuickScanTime                        = '00:00:00'
                    defenderScheduledScanTime                             = '00:00:00'
                    defenderScheduleScanEnableLowCpuPriority              = $True
                    defenderSignatureUpdateIntervalInHours                = 25
                    defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                    defenderSystemScanSchedule                            = 'userDefined'
                    description                                           = 'FakeStringValue'
                    developerUnlockSetting                                = 'notConfigured'
                    deviceManagementBlockFactoryResetOnMobile             = $True
                    deviceManagementBlockManualUnenroll                   = $True
                    diagnosticsDataSubmissionMode                         = 'userDefined'
                    displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                    displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                    displayName                                           = 'FakeStringValue'
                    edgeAllowStartPagesModification                       = $True
                    edgeBlockAccessToAboutFlags                           = $True
                    edgeBlockAddressBarDropdown                           = $True
                    edgeBlockAutofill                                     = $True
                    edgeBlockCompatibilityList                            = $True
                    edgeBlockDeveloperTools                               = $True
                    edgeBlocked                                           = $True
                    edgeBlockEditFavorites                                = $True
                    edgeBlockExtensions                                   = $True
                    edgeBlockFullScreenMode                               = $True
                    edgeBlockInPrivateBrowsing                            = $True
                    edgeBlockJavaScript                                   = $True
                    edgeBlockLiveTileDataCollection                       = $True
                    edgeBlockPasswordManager                              = $True
                    edgeBlockPopups                                       = $True
                    edgeBlockPrelaunch                                    = $True
                    edgeBlockPrinting                                     = $True
                    edgeBlockSavingHistory                                = $True
                    edgeBlockSearchEngineCustomization                    = $True
                    edgeBlockSearchSuggestions                            = $True
                    edgeBlockSendingDoNotTrackHeader                      = $True
                    edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                    edgeBlockSideloadingExtensions                        = $True
                    edgeBlockTabPreloading                                = $True
                    edgeBlockWebContentOnNewTabPage                       = $True
                    edgeClearBrowsingDataOnExit                           = $True
                    edgeCookiePolicy                                      = 'userDefined'
                    edgeDisableFirstRunPage                               = $True
                    edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                    edgeFavoritesBarVisibility                            = 'notConfigured'
                    edgeFavoritesListLocation                             = 'FakeStringValue'
                    edgeFirstRunUrl                                       = 'FakeStringValue'
                    edgeHomeButtonConfiguration                           = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeHomeButtonConfiguration -Property @{
                            odataType           = '#microsoft.graph.edgeHomeButtonHidden'
                            homeButtonCustomURL = 'FakeStringValue'
                        } -ClientOnly)
                    edgeHomeButtonConfigurationEnabled                    = $True
                    edgeHomepageUrls                                      = @('FakeStringValue')
                    edgeKioskModeRestriction                              = 'notConfigured'
                    edgeKioskResetAfterIdleTimeInMinutes                  = 25
                    edgeNewTabPageURL                                     = 'FakeStringValue'
                    edgeOpensWith                                         = 'notConfigured'
                    edgePreventCertificateErrorOverride                   = $True
                    edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                    edgeRequireSmartScreen                                = $True
                    edgeSearchEngine                                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeSearchEngineBase -Property @{
                            edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                            edgeSearchEngineType             = 'default'
                            odataType                        = '#microsoft.graph.edgeSearchEngine'
                        } -ClientOnly)
                    edgeSendIntranetTrafficToInternetExplorer             = $True
                    edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                    edgeSyncFavoritesWithInternetExplorer                 = $True
                    edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                    enableAutomaticRedeployment                           = $True
                    energySaverOnBatteryThresholdPercentage               = 25
                    energySaverPluggedInThresholdPercentage               = 25
                    enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                    enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                    enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                    enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                    enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                    enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                    experienceBlockDeviceDiscovery                        = $True
                    experienceBlockErrorDialogWhenNoSIM                   = $True
                    experienceBlockTaskSwitcher                           = $True
                    experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                    findMyFiles                                           = 'notConfigured'
                    gameDvrBlocked                                        = $True
                    id                                                    = 'FakeStringValue'
                    inkWorkspaceAccess                                    = 'notConfigured'
                    inkWorkspaceAccessState                               = 'notConfigured'
                    inkWorkspaceBlockSuggestedApps                        = $True
                    internetSharingBlocked                                = $True
                    locationServicesBlocked                               = $True
                    lockScreenActivateAppsWithVoice                       = 'notConfigured'
                    lockScreenAllowTimeoutConfiguration                   = $True
                    lockScreenBlockActionCenterNotifications              = $True
                    lockScreenBlockCortana                                = $True
                    lockScreenBlockToastNotifications                     = $True
                    lockScreenTimeoutInSeconds                            = 25
                    logonBlockFastUserSwitching                           = $True
                    messagingBlockMMS                                     = $True
                    messagingBlockRichCommunicationServices               = $True
                    messagingBlockSync                                    = $True
                    microsoftAccountBlocked                               = $True
                    microsoftAccountBlockSettingsSync                     = $True
                    microsoftAccountSignInAssistantSettings               = 'notConfigured'
                    networkProxyApplySettingsDeviceWide                   = $True
                    networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                    networkProxyDisableAutoDetect                         = $True
                    networkProxyServer                                    = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10NetworkProxyServer -Property @{
                            useForLocalAddresses = $True
                            exceptions           = @('FakeStringValue')
                            address              = 'FakeStringValue'
                        } -ClientOnly)
                    nfcBlocked                                            = $True
                    oneDriveDisableFileSync                               = $True
                    passwordBlockSimple                                   = $True
                    passwordExpirationDays                                = 25
                    passwordMinimumAgeInDays                              = 25
                    passwordMinimumCharacterSetCount                      = 25
                    passwordMinimumLength                                 = 25
                    passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                    passwordPreviousPasswordBlockCount                    = 25
                    passwordRequired                                      = $True
                    passwordRequiredType                                  = 'deviceDefault'
                    passwordRequireWhenResumeFromIdleState                = $True
                    passwordSignInFailureCountBeforeFactoryReset          = 25
                    personalizationDesktopImageUrl                        = 'FakeStringValue'
                    personalizationLockScreenImageUrl                     = 'FakeStringValue'
                    powerButtonActionOnBattery                            = 'notConfigured'
                    powerButtonActionPluggedIn                            = 'notConfigured'
                    powerHybridSleepOnBattery                             = 'notConfigured'
                    powerHybridSleepPluggedIn                             = 'notConfigured'
                    powerLidCloseActionOnBattery                          = 'notConfigured'
                    powerLidCloseActionPluggedIn                          = 'notConfigured'
                    powerSleepButtonActionOnBattery                       = 'notConfigured'
                    powerSleepButtonActionPluggedIn                       = 'notConfigured'
                    printerBlockAddition                                  = $True
                    printerDefaultName                                    = 'FakeStringValue'
                    printerNames                                          = @('FakeStringValue')
                    privacyAdvertisingId                                  = 'notConfigured'
                    privacyAutoAcceptPairingAndConsentPrompts             = $True
                    privacyBlockActivityFeed                              = $True
                    privacyBlockInputPersonalization                      = $True
                    privacyBlockPublishUserActivities                     = $True
                    privacyDisableLaunchExperience                        = $True
                    resetProtectionModeBlocked                            = $True
                    safeSearchFilter                                      = 'userDefined'
                    screenCaptureBlocked                                  = $True
                    searchBlockDiacritics                                 = $True
                    searchBlockWebResults                                 = $True
                    searchDisableAutoLanguageDetection                    = $True
                    searchDisableIndexerBackoff                           = $True
                    searchDisableIndexingEncryptedItems                   = $True
                    searchDisableIndexingRemovableDrive                   = $True
                    searchDisableLocation                                 = $True
                    searchDisableUseLocation                              = $True
                    searchEnableAutomaticIndexSizeManangement             = $True
                    searchEnableRemoteQueries                             = $True
                    securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                    settingsBlockAccountsPage                             = $True
                    settingsBlockAddProvisioningPackage                   = $True
                    settingsBlockAppsPage                                 = $True
                    settingsBlockChangeLanguage                           = $True
                    settingsBlockChangePowerSleep                         = $True
                    settingsBlockChangeRegion                             = $True
                    settingsBlockChangeSystemTime                         = $True
                    settingsBlockDevicesPage                              = $True
                    settingsBlockEaseOfAccessPage                         = $True
                    settingsBlockEditDeviceName                           = $True
                    settingsBlockGamingPage                               = $True
                    settingsBlockNetworkInternetPage                      = $True
                    settingsBlockPersonalizationPage                      = $True
                    settingsBlockPrivacyPage                              = $True
                    settingsBlockRemoveProvisioningPackage                = $True
                    settingsBlockSettingsApp                              = $True
                    settingsBlockSystemPage                               = $True
                    settingsBlockTimeLanguagePage                         = $True
                    settingsBlockUpdateSecurityPage                       = $True
                    sharedUserAppDataAllowed                              = $True
                    smartScreenAppInstallControl                          = 'notConfigured'
                    smartScreenBlockPromptOverride                        = $True
                    smartScreenBlockPromptOverrideForFiles                = $True
                    smartScreenEnableAppInstallControl                    = $True
                    startBlockUnpinningAppsFromTaskbar                    = $True
                    startMenuAppListVisibility                            = 'userDefined'
                    startMenuHideChangeAccountSettings                    = $True
                    startMenuHideFrequentlyUsedApps                       = $True
                    startMenuHideHibernate                                = $True
                    startMenuHideLock                                     = $True
                    startMenuHidePowerButton                              = $True
                    startMenuHideRecentJumpLists                          = $True
                    startMenuHideRecentlyAddedApps                        = $True
                    startMenuHideRestartOptions                           = $True
                    startMenuHideShutDown                                 = $True
                    startMenuHideSignOut                                  = $True
                    startMenuHideSleep                                    = $True
                    startMenuHideSwitchAccount                            = $True
                    startMenuHideUserTile                                 = $True
                    startMenuLayoutEdgeAssetsXml                          = $True
                    startMenuLayoutXml                                    = $True
                    startMenuMode                                         = 'userDefined'
                    startMenuPinnedFolderDocuments                        = 'notConfigured'
                    startMenuPinnedFolderDownloads                        = 'notConfigured'
                    startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                    startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                    startMenuPinnedFolderMusic                            = 'notConfigured'
                    startMenuPinnedFolderNetwork                          = 'notConfigured'
                    startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                    startMenuPinnedFolderPictures                         = 'notConfigured'
                    startMenuPinnedFolderSettings                         = 'notConfigured'
                    startMenuPinnedFolderVideos                           = 'notConfigured'
                    storageBlockRemovableStorage                          = $True
                    storageRequireMobileDeviceEncryption                  = $True
                    storageRestrictAppDataToSystemVolume                  = $True
                    storageRestrictAppInstallToSystemVolume               = $True
                    supportsScopeTags                                     = $True
                    systemTelemetryProxyServer                            = 'FakeStringValue'
                    taskManagerBlockEndTask                               = $True
                    tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                    uninstallBuiltInApps                                  = $True
                    usbBlocked                                            = $True
                    voiceRecordingBlocked                                 = $True
                    webRtcBlockLocalhostIpAddress                         = $True
                    wiFiBlockAutomaticConnectHotspots                     = $True
                    wiFiBlocked                                           = $True
                    wiFiBlockManualConfiguration                          = $True
                    wiFiScanInterval                                      = 25
                    windows10AppsForceUpdateSchedule                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10AppsForceUpdateSchedule -Property @{
                            runImmediatelyIfAfterStartDateTime = $True
                            recurrence                         = 'none'
                            startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                        } -ClientOnly)
                    windowsSpotlightBlockConsumerSpecificFeatures         = $True
                    windowsSpotlightBlocked                               = $True
                    windowsSpotlightBlockOnActionCenter                   = $True
                    windowsSpotlightBlockTailoredExperiences              = $True
                    windowsSpotlightBlockThirdPartyNotifications          = $True
                    windowsSpotlightBlockWelcomeExperience                = $True
                    windowsSpotlightBlockWindowsTips                      = $True
                    windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                    windowsStoreBlockAutoUpdate                           = $True
                    windowsStoreBlocked                                   = $True
                    windowsStoreEnablePrivateStoreOnly                    = $True
                    wirelessDisplayBlockProjectionToThisDevice            = $True
                    wirelessDisplayBlockUserInputFromReceiver             = $True
                    wirelessDisplayRequirePinForPairing                   = $True
                    Ensure                                                = 'Present'
                    Credential                                            = $Credential
                }

                Mock -CommandName Get-MgBetaDeviceManagementDeviceConfiguration -MockWith {
                    return @{
                        AdditionalProperties = @{
                            enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                            startMenuHideSwitchAccount                            = $True
                            defenderBlockEndUserAccess                            = $True
                            searchEnableAutomaticIndexSizeManangement             = $True
                            defenderRequireNetworkInspectionSystem                = $True
                            settingsBlockGamingPage                               = $True
                            smartScreenBlockPromptOverrideForFiles                = $True
                            passwordBlockSimple                                   = $True
                            powerLidCloseActionPluggedIn                          = 'notConfigured'
                            defenderRequireCloudProtection                        = $True
                            defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                            resetProtectionModeBlocked                            = $True
                            startBlockUnpinningAppsFromTaskbar                    = $True
                            networkProxyApplySettingsDeviceWide                   = $True
                            bluetoothAllowedServices                              = @('FakeStringValue')
                            defenderScanArchiveFiles                              = $True
                            lockScreenActivateAppsWithVoice                       = 'notConfigured'
                            defenderScanIncomingMail                              = $True
                            edgeBlockAutofill                                     = $True
                            authenticationAllowSecondaryDevice                    = $True
                            edgeRequireSmartScreen                                = $True
                            windowsSpotlightBlockOnActionCenter                   = $True
                            usbBlocked                                            = $True
                            enableAutomaticRedeployment                           = $True
                            microsoftAccountSignInAssistantSettings               = 'notConfigured'
                            deviceManagementBlockFactoryResetOnMobile             = $True
                            defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                            powerButtonActionOnBattery                            = 'notConfigured'
                            startMenuAppListVisibility                            = 'userDefined'
                            lockScreenBlockCortana                                = $True
                            windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                            startMenuPinnedFolderPictures                         = 'notConfigured'
                            screenCaptureBlocked                                  = $True
                            webRtcBlockLocalhostIpAddress                         = $True
                            safeSearchFilter                                      = 'userDefined'
                            searchDisableLocation                                 = $True
                            edgeBlockInPrivateBrowsing                            = $True
                            appManagementMSIAllowUserControlOverInstall           = $True
                            defenderSignatureUpdateIntervalInHours                = 25
                            startMenuHideSleep                                    = $True
                            voiceRecordingBlocked                                 = $True
                            edgeFavoritesListLocation                             = 'FakeStringValue'
                            startMenuHideLock                                     = $True
                            wiFiBlockManualConfiguration                          = $True
                            edgeBlockTabPreloading                                = $True
                            configureTimeZone                                     = 'FakeStringValue'
                            edgeBlocked                                           = $True
                            taskManagerBlockEndTask                               = $True
                            settingsBlockAppsPage                                 = $True
                            settingsBlockChangePowerSleep                         = $True
                            copyPasteBlocked                                      = $True
                            settingsBlockNetworkInternetPage                      = $True
                            privacyBlockInputPersonalization                      = $True
                            appManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                            powerLidCloseActionOnBattery                          = 'notConfigured'
                            searchDisableIndexerBackoff                           = $True
                            edgeBlockFullScreenMode                               = $True
                            lockScreenTimeoutInSeconds                            = 25
                            developerUnlockSetting                                = 'notConfigured'
                            storageRestrictAppDataToSystemVolume                  = $True
                            cellularBlockVpn                                      = $True
                            powerHybridSleepPluggedIn                             = 'notConfigured'
                            settingsBlockChangeLanguage                           = $True
                            powerSleepButtonActionOnBattery                       = 'notConfigured'
                            antiTheftModeBlocked                                  = $True
                            defenderMonitorFileActivity                           = 'userDefined'
                            defenderFileExtensionsToExclude                       = @('FakeStringValue')
                            bluetoothBlockDiscoverableMode                        = $True
                            enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                            diagnosticsDataSubmissionMode                         = 'userDefined'
                            uninstallBuiltInApps                                  = $True
                            oneDriveDisableFileSync                               = $True
                            startMenuHideUserTile                                 = $True
                            startMenuHideSignOut                                  = $True
                            defenderDaysBeforeDeletingQuarantinedMalware          = 25
                            privacyAutoAcceptPairingAndConsentPrompts             = $True
                            settingsBlockChangeRegion                             = $True
                            passwordMinimumAgeInDays                              = 25
                            powerHybridSleepOnBattery                             = 'notConfigured'
                            displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                            edgeBlockSearchSuggestions                            = $True
                            settingsBlockSystemPage                               = $True
                            defenderRequireBehaviorMonitoring                     = $True
                            microsoftAccountBlockSettingsSync                     = $True
                            windowsSpotlightBlockWindowsTips                      = $True
                            startMenuHideRecentlyAddedApps                        = $True
                            inkWorkspaceBlockSuggestedApps                        = $True
                            personalizationDesktopImageUrl                        = 'FakeStringValue'
                            edgeHomeButtonConfigurationEnabled                    = $True
                            passwordRequiredType                                  = 'deviceDefault'
                            startMenuPinnedFolderSettings                         = 'notConfigured'
                            connectedDevicesServiceBlocked                        = $True
                            edgeBlockExtensions                                   = $True
                            edgeBlockAddressBarDropdown                           = $True
                            findMyFiles                                           = 'notConfigured'
                            privacyBlockPublishUserActivities                     = $True
                            startMenuHideFrequentlyUsedApps                       = $True
                            '@odata.type'                                         = '#microsoft.graph.windows10GeneralConfiguration'
                            powerSleepButtonActionPluggedIn                       = 'notConfigured'
                            internetSharingBlocked                                = $True
                            startMenuHidePowerButton                              = $True
                            networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                            personalizationLockScreenImageUrl                     = 'FakeStringValue'
                            bluetoothBlockPrePairing                              = $True
                            windowsSpotlightBlockWelcomeExperience                = $True
                            startMenuHideShutDown                                 = $True
                            storageRestrictAppInstallToSystemVolume               = $True
                            windowsSpotlightBlockThirdPartyNotifications          = $True
                            searchDisableAutoLanguageDetection                    = $True
                            edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                            appsAllowTrustedAppsSideloading                       = 'notConfigured'
                            edgeBlockLiveTileDataCollection                       = $True
                            wirelessDisplayBlockProjectionToThisDevice            = $True
                            startMenuHideRestartOptions                           = $True
                            edgeSendIntranetTrafficToInternetExplorer             = $True
                            startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                            edgeBlockWebContentOnNewTabPage                       = $True
                            startMenuLayoutXml                                    = $True
                            searchBlockDiacritics                                 = $True
                            storageBlockRemovableStorage                          = $True
                            enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                            wirelessDisplayRequirePinForPairing                   = $True
                            defenderScheduledQuickScanTime                        = '00:00:00'
                            edgeAllowStartPagesModification                       = $True
                            defenderRequireRealTimeMonitoring                     = $True
                            authenticationWebSignIn                               = 'notConfigured'
                            lockScreenBlockToastNotifications                     = $True
                            energySaverPluggedInThresholdPercentage               = 25
                            defenderScanMappedNetworkDrivesDuringFullScan         = $True
                            smartScreenBlockPromptOverride                        = $True
                            edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                            authenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                            defenderScanType                                      = 'userDefined'
                            bluetoothBlockAdvertising                             = $True
                            enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                            logonBlockFastUserSwitching                           = $True
                            networkProxyDisableAutoDetect                         = $True
                            cameraBlocked                                         = $True
                            wiFiScanInterval                                      = 25
                            edgeBlockSideloadingExtensions                        = $True
                            settingsBlockEaseOfAccessPage                         = $True
                            microsoftAccountBlocked                               = $True
                            defenderScanRemovableDrivesDuringFullScan             = $True
                            energySaverOnBatteryThresholdPercentage               = 25
                            startMenuHideHibernate                                = $True
                            defenderScanDownloads                                 = $True
                            defenderBlockOnAccessProtection                       = $True
                            defenderCloudBlockLevel                               = 'notConfigured'
                            storageRequireMobileDeviceEncryption                  = $True
                            windowsStoreEnablePrivateStoreOnly                    = $True
                            edgeBlockCompatibilityList                            = $True
                            wiFiBlockAutomaticConnectHotspots                     = $True
                            defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                            defenderCloudExtendedTimeout                          = 25
                            edgeHomepageUrls                                      = @('FakeStringValue')
                            cellularBlockDataWhenRoaming                          = $True
                            securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                            smartScreenAppInstallControl                          = 'notConfigured'
                            enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                            bluetoothBlockPromptedProximalConnections             = $True
                            settingsBlockPrivacyPage                              = $True
                            windowsSpotlightBlocked                               = $True
                            tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                            startMenuPinnedFolderDocuments                        = 'notConfigured'
                            systemTelemetryProxyServer                            = 'FakeStringValue'
                            lockScreenAllowTimeoutConfiguration                   = $True
                            defenderSystemScanSchedule                            = 'userDefined'
                            windowsSpotlightBlockConsumerSpecificFeatures         = $True
                            searchDisableUseLocation                              = $True
                            appsBlockWindowsStoreOriginatedApps                   = $True
                            startMenuPinnedFolderNetwork                          = 'notConfigured'
                            edgeBlockPrinting                                     = $True
                            settingsBlockEditDeviceName                           = $True
                            printerNames                                          = @('FakeStringValue')
                            settingsBlockUpdateSecurityPage                       = $True
                            startMenuMode                                         = 'userDefined'
                            searchBlockWebResults                                 = $True
                            edgePreventCertificateErrorOverride                   = $True
                            passwordRequired                                      = $True
                            defenderScanNetworkFiles                              = $True
                            startMenuPinnedFolderMusic                            = 'notConfigured'
                            cortanaBlocked                                        = $True
                            searchEnableRemoteQueries                             = $True
                            messagingBlockSync                                    = $True
                            startMenuPinnedFolderVideos                           = 'notConfigured'
                            enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                            experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                            edgeDisableFirstRunPage                               = $True
                            edgeCookiePolicy                                      = 'userDefined'
                            inkWorkspaceAccessState                               = 'notConfigured'
                            windows10AppsForceUpdateSchedule                      = @{
                                runImmediatelyIfAfterStartDateTime = $True
                                recurrence                         = 'none'
                                startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                            }
                            dataProtectionBlockDirectMemoryAccess                 = $True
                            experienceBlockErrorDialogWhenNoSIM                   = $True
                            settingsBlockPersonalizationPage                      = $True
                            wirelessDisplayBlockUserInputFromReceiver             = $True
                            startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                            activateAppsWithVoice                                 = 'notConfigured'
                            edgeClearBrowsingDataOnExit                           = $True
                            passwordPreviousPasswordBlockCount                    = 25
                            edgeBlockSearchEngineCustomization                    = $True
                            deviceManagementBlockManualUnenroll                   = $True
                            edgeBlockSavingHistory                                = $True
                            inkWorkspaceAccess                                    = 'notConfigured'
                            startMenuHideRecentJumpLists                          = $True
                            privacyBlockActivityFeed                              = $True
                            settingsBlockChangeSystemTime                         = $True
                            defenderDisableCatchupQuickScan                       = $True
                            smartScreenEnableAppInstallControl                    = $True
                            edgeBlockDeveloperTools                               = $True
                            edgeKioskModeRestriction                              = 'notConfigured'
                            lockScreenBlockActionCenterNotifications              = $True
                            privacyAdvertisingId                                  = 'notConfigured'
                            settingsBlockSettingsApp                              = $True
                            settingsBlockAccountsPage                             = $True
                            certificatesBlockManualRootCertificateInstallation    = $True
                            edgeBlockJavaScript                                   = $True
                            edgeSyncFavoritesWithInternetExplorer                 = $True
                            startMenuLayoutEdgeAssetsXml                          = $True
                            windowsSpotlightBlockTailoredExperiences              = $True
                            defenderPromptForSampleSubmission                     = 'userDefined'
                            edgeBlockAccessToAboutFlags                           = $True
                            messagingBlockMMS                                     = $True
                            edgeBlockEditFavorites                                = $True
                            printerDefaultName                                    = 'FakeStringValue'
                            experienceBlockDeviceDiscovery                        = $True
                            privacyDisableLaunchExperience                        = $True
                            edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                            nfcBlocked                                            = $True
                            searchDisableIndexingRemovableDrive                   = $True
                            powerButtonActionPluggedIn                            = 'notConfigured'
                            settingsBlockRemoveProvisioningPackage                = $True
                            edgeKioskResetAfterIdleTimeInMinutes                  = 25
                            passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                            printerBlockAddition                                  = $True
                            defenderScanScriptsLoadedInInternetExplorer           = $True
                            defenderDisableCatchupFullScan                        = $True
                            edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                            bluetoothBlocked                                      = $True
                            settingsBlockAddProvisioningPackage                   = $True
                            passwordMinimumLength                                 = 25
                            startMenuHideChangeAccountSettings                    = $True
                            defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                            edgeBlockPopups                                       = $True
                            networkProxyServer                                    = @{
                                useForLocalAddresses = $True
                                exceptions           = @('FakeStringValue')
                                address              = 'FakeStringValue'
                            }
                            startMenuPinnedFolderDownloads                        = 'notConfigured'
                            settingsBlockDevicesPage                              = $True
                            wiFiBlocked                                           = $True
                            windowsStoreBlocked                                   = $True
                            edgeBlockPrelaunch                                    = $True
                            gameDvrBlocked                                        = $True
                            experienceBlockTaskSwitcher                           = $True
                            edgeBlockPasswordManager                              = $True
                            passwordSignInFailureCountBeforeFactoryReset          = 25
                            passwordMinimumCharacterSetCount                      = 25
                            searchDisableIndexingEncryptedItems                   = $True
                            appManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                            cellularData                                          = 'blocked'
                            defenderScheduledScanTime                             = '00:00:00'
                            edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                            defenderProcessesToExclude                            = @('FakeStringValue')
                            defenderDetectedMalwareActions                        = @{
                                lowSeverity      = 'deviceDefault'
                                severeSeverity   = 'deviceDefault'
                                moderateSeverity = 'deviceDefault'
                                highSeverity     = 'deviceDefault'
                            }
                            edgeHomeButtonConfiguration                           = @{
                                homeButtonCustomURL = 'FakeStringValue'
                                '@odata.type'       = '#microsoft.graph.edgeHomeButtonHidden'
                            }
                            cryptographyAllowFipsAlgorithmPolicy                  = $True
                            sharedUserAppDataAllowed                              = $True
                            edgeFirstRunUrl                                       = 'FakeStringValue'
                            edgeBlockSendingDoNotTrackHeader                      = $True
                            edgeOpensWith                                         = 'notConfigured'
                            defenderScheduleScanEnableLowCpuPriority              = $True
                            windowsStoreBlockAutoUpdate                           = $True
                            messagingBlockRichCommunicationServices               = $True
                            edgeNewTabPageURL                                     = 'FakeStringValue'
                            passwordRequireWhenResumeFromIdleState                = $True
                            passwordExpirationDays                                = 25
                            displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                            settingsBlockTimeLanguagePage                         = $True
                            locationServicesBlocked                               = $True
                            defenderScanMaxCpu                                    = 25
                            edgeFavoritesBarVisibility                            = 'notConfigured'
                            accountsBlockAddingNonMicrosoftAccountEmail           = $True
                            defenderCloudExtendedTimeoutInSeconds                 = 25
                            cellularBlockVpnWhenRoaming                           = $True
                            startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                            edgeSearchEngine                                      = @{
                                edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                                edgeSearchEngineType             = 'default'
                                '@odata.type'                    = '#microsoft.graph.edgeSearchEngine'
                            }
                        }
                        description          = 'FakeStringValue'
                        displayName          = 'FakeStringValue'
                        id                   = 'FakeStringValue'
                        supportsScopeTags    = $True

                    }
                }
            }


            It 'Should return true from the Test method' {
                Test-TargetResource @testParams | Should -Be $true
            }
        }

        Context -Name 'The IntuneDeviceConfigurationPolicyWindows10 exists and values are NOT in the desired state' -Fixture {
            BeforeAll {
                $testParams = @{
                    AccountsBlockAddingNonMicrosoftAccountEmail           = $True
                    ActivateAppsWithVoice                                 = 'notConfigured'
                    AntiTheftModeBlocked                                  = $True
                    AppManagementMSIAllowUserControlOverInstall           = $True
                    AppManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                    AppManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                    AppsAllowTrustedAppsSideloading                       = 'notConfigured'
                    AppsBlockWindowsStoreOriginatedApps                   = $True
                    AuthenticationAllowSecondaryDevice                    = $True
                    AuthenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                    AuthenticationWebSignIn                               = 'notConfigured'
                    BluetoothAllowedServices                              = @('FakeStringValue')
                    BluetoothBlockAdvertising                             = $True
                    BluetoothBlockDiscoverableMode                        = $True
                    BluetoothBlocked                                      = $True
                    BluetoothBlockPrePairing                              = $True
                    BluetoothBlockPromptedProximalConnections             = $True
                    CameraBlocked                                         = $True
                    CellularBlockDataWhenRoaming                          = $True
                    CellularBlockVpn                                      = $True
                    CellularBlockVpnWhenRoaming                           = $True
                    CellularData                                          = 'blocked'
                    CertificatesBlockManualRootCertificateInstallation    = $True
                    ConfigureTimeZone                                     = 'FakeStringValue'
                    ConnectedDevicesServiceBlocked                        = $True
                    CopyPasteBlocked                                      = $True
                    CortanaBlocked                                        = $True
                    CryptographyAllowFipsAlgorithmPolicy                  = $True
                    DataProtectionBlockDirectMemoryAccess                 = $True
                    DefenderBlockEndUserAccess                            = $True
                    DefenderBlockOnAccessProtection                       = $True
                    DefenderCloudBlockLevel                               = 'notConfigured'
                    DefenderCloudExtendedTimeout                          = 25
                    DefenderCloudExtendedTimeoutInSeconds                 = 25
                    DefenderDaysBeforeDeletingQuarantinedMalware          = 25
                    defenderDetectedMalwareActions                        = (New-CimInstance -ClassName MSFT_MicrosoftGraphdefenderDetectedMalwareActions1 -Property @{
                            lowSeverity      = 'deviceDefault'
                            severeSeverity   = 'deviceDefault'
                            moderateSeverity = 'deviceDefault'
                            highSeverity     = 'deviceDefault'
                        } -ClientOnly)
                    defenderDisableCatchupFullScan                        = $True
                    defenderDisableCatchupQuickScan                       = $True
                    defenderFileExtensionsToExclude                       = @('FakeStringValue')
                    defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                    defenderMonitorFileActivity                           = 'userDefined'
                    defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                    defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                    defenderProcessesToExclude                            = @('FakeStringValue')
                    defenderPromptForSampleSubmission                     = 'userDefined'
                    defenderRequireBehaviorMonitoring                     = $True
                    defenderRequireCloudProtection                        = $True
                    defenderRequireNetworkInspectionSystem                = $True
                    defenderRequireRealTimeMonitoring                     = $True
                    defenderScanArchiveFiles                              = $True
                    defenderScanDownloads                                 = $True
                    defenderScanIncomingMail                              = $True
                    defenderScanMappedNetworkDrivesDuringFullScan         = $True
                    defenderScanMaxCpu                                    = 25
                    defenderScanNetworkFiles                              = $True
                    defenderScanRemovableDrivesDuringFullScan             = $True
                    defenderScanScriptsLoadedInInternetExplorer           = $True
                    defenderScanType                                      = 'userDefined'
                    defenderScheduledQuickScanTime                        = '00:00:00'
                    defenderScheduledScanTime                             = '00:00:00'
                    defenderScheduleScanEnableLowCpuPriority              = $True
                    defenderSignatureUpdateIntervalInHours                = 25
                    defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                    defenderSystemScanSchedule                            = 'userDefined'
                    description                                           = 'FakeStringValue'
                    developerUnlockSetting                                = 'notConfigured'
                    deviceManagementBlockFactoryResetOnMobile             = $True
                    deviceManagementBlockManualUnenroll                   = $True
                    diagnosticsDataSubmissionMode                         = 'userDefined'
                    displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                    displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                    displayName                                           = 'FakeStringValue'
                    edgeAllowStartPagesModification                       = $True
                    edgeBlockAccessToAboutFlags                           = $True
                    edgeBlockAddressBarDropdown                           = $True
                    edgeBlockAutofill                                     = $True
                    edgeBlockCompatibilityList                            = $True
                    edgeBlockDeveloperTools                               = $True
                    edgeBlocked                                           = $True
                    edgeBlockEditFavorites                                = $True
                    edgeBlockExtensions                                   = $True
                    edgeBlockFullScreenMode                               = $True
                    edgeBlockInPrivateBrowsing                            = $True
                    edgeBlockJavaScript                                   = $True
                    edgeBlockLiveTileDataCollection                       = $True
                    edgeBlockPasswordManager                              = $True
                    edgeBlockPopups                                       = $True
                    edgeBlockPrelaunch                                    = $True
                    edgeBlockPrinting                                     = $True
                    edgeBlockSavingHistory                                = $True
                    edgeBlockSearchEngineCustomization                    = $True
                    edgeBlockSearchSuggestions                            = $True
                    edgeBlockSendingDoNotTrackHeader                      = $True
                    edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                    edgeBlockSideloadingExtensions                        = $True
                    edgeBlockTabPreloading                                = $True
                    edgeBlockWebContentOnNewTabPage                       = $True
                    edgeClearBrowsingDataOnExit                           = $True
                    edgeCookiePolicy                                      = 'userDefined'
                    edgeDisableFirstRunPage                               = $True
                    edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                    edgeFavoritesBarVisibility                            = 'notConfigured'
                    edgeFavoritesListLocation                             = 'FakeStringValue'
                    edgeFirstRunUrl                                       = 'FakeStringValue'
                    edgeHomeButtonConfiguration                           = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeHomeButtonConfiguration -Property @{
                            odataType           = '#microsoft.graph.edgeHomeButtonHidden'
                            homeButtonCustomURL = 'FakeStringValue'
                        } -ClientOnly)
                    edgeHomeButtonConfigurationEnabled                    = $True
                    edgeHomepageUrls                                      = @('FakeStringValue')
                    edgeKioskModeRestriction                              = 'notConfigured'
                    edgeKioskResetAfterIdleTimeInMinutes                  = 25
                    edgeNewTabPageURL                                     = 'FakeStringValue'
                    edgeOpensWith                                         = 'notConfigured'
                    edgePreventCertificateErrorOverride                   = $True
                    edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                    edgeRequireSmartScreen                                = $True
                    edgeSearchEngine                                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphedgeSearchEngineBase -Property @{
                            edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                            edgeSearchEngineType             = 'default'
                            odataType                        = '#microsoft.graph.edgeSearchEngine'
                        } -ClientOnly)
                    edgeSendIntranetTrafficToInternetExplorer             = $True
                    edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                    edgeSyncFavoritesWithInternetExplorer                 = $True
                    edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                    enableAutomaticRedeployment                           = $True
                    energySaverOnBatteryThresholdPercentage               = 25
                    energySaverPluggedInThresholdPercentage               = 25
                    enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                    enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                    enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                    enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                    enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                    enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                    experienceBlockDeviceDiscovery                        = $True
                    experienceBlockErrorDialogWhenNoSIM                   = $True
                    experienceBlockTaskSwitcher                           = $True
                    experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                    findMyFiles                                           = 'notConfigured'
                    gameDvrBlocked                                        = $True
                    id                                                    = 'FakeStringValue'
                    inkWorkspaceAccess                                    = 'notConfigured'
                    inkWorkspaceAccessState                               = 'notConfigured'
                    inkWorkspaceBlockSuggestedApps                        = $True
                    internetSharingBlocked                                = $True
                    locationServicesBlocked                               = $True
                    lockScreenActivateAppsWithVoice                       = 'notConfigured'
                    lockScreenAllowTimeoutConfiguration                   = $True
                    lockScreenBlockActionCenterNotifications              = $True
                    lockScreenBlockCortana                                = $True
                    lockScreenBlockToastNotifications                     = $True
                    lockScreenTimeoutInSeconds                            = 25
                    logonBlockFastUserSwitching                           = $True
                    messagingBlockMMS                                     = $True
                    messagingBlockRichCommunicationServices               = $True
                    messagingBlockSync                                    = $True
                    microsoftAccountBlocked                               = $True
                    microsoftAccountBlockSettingsSync                     = $True
                    microsoftAccountSignInAssistantSettings               = 'notConfigured'
                    networkProxyApplySettingsDeviceWide                   = $True
                    networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                    networkProxyDisableAutoDetect                         = $True
                    networkProxyServer                                    = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10NetworkProxyServer -Property @{
                            useForLocalAddresses = $True
                            exceptions           = @('FakeStringValue')
                            address              = 'FakeStringValue'
                        } -ClientOnly)
                    nfcBlocked                                            = $True
                    oneDriveDisableFileSync                               = $True
                    passwordBlockSimple                                   = $True
                    passwordExpirationDays                                = 25
                    passwordMinimumAgeInDays                              = 25
                    passwordMinimumCharacterSetCount                      = 25
                    passwordMinimumLength                                 = 25
                    passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                    passwordPreviousPasswordBlockCount                    = 25
                    passwordRequired                                      = $True
                    passwordRequiredType                                  = 'deviceDefault'
                    passwordRequireWhenResumeFromIdleState                = $True
                    passwordSignInFailureCountBeforeFactoryReset          = 25
                    personalizationDesktopImageUrl                        = 'FakeStringValue'
                    personalizationLockScreenImageUrl                     = 'FakeStringValue'
                    powerButtonActionOnBattery                            = 'notConfigured'
                    powerButtonActionPluggedIn                            = 'notConfigured'
                    powerHybridSleepOnBattery                             = 'notConfigured'
                    powerHybridSleepPluggedIn                             = 'notConfigured'
                    powerLidCloseActionOnBattery                          = 'notConfigured'
                    powerLidCloseActionPluggedIn                          = 'notConfigured'
                    powerSleepButtonActionOnBattery                       = 'notConfigured'
                    powerSleepButtonActionPluggedIn                       = 'notConfigured'
                    printerBlockAddition                                  = $True
                    printerDefaultName                                    = 'FakeStringValue'
                    printerNames                                          = @('FakeStringValue')
                    privacyAdvertisingId                                  = 'notConfigured'
                    privacyAutoAcceptPairingAndConsentPrompts             = $True
                    privacyBlockActivityFeed                              = $True
                    privacyBlockInputPersonalization                      = $True
                    privacyBlockPublishUserActivities                     = $True
                    privacyDisableLaunchExperience                        = $True
                    resetProtectionModeBlocked                            = $True
                    safeSearchFilter                                      = 'userDefined'
                    screenCaptureBlocked                                  = $True
                    searchBlockDiacritics                                 = $True
                    searchBlockWebResults                                 = $True
                    searchDisableAutoLanguageDetection                    = $True
                    searchDisableIndexerBackoff                           = $True
                    searchDisableIndexingEncryptedItems                   = $True
                    searchDisableIndexingRemovableDrive                   = $True
                    searchDisableLocation                                 = $True
                    searchDisableUseLocation                              = $True
                    searchEnableAutomaticIndexSizeManangement             = $True
                    searchEnableRemoteQueries                             = $True
                    securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                    settingsBlockAccountsPage                             = $True
                    settingsBlockAddProvisioningPackage                   = $True
                    settingsBlockAppsPage                                 = $True
                    settingsBlockChangeLanguage                           = $True
                    settingsBlockChangePowerSleep                         = $True
                    settingsBlockChangeRegion                             = $True
                    settingsBlockChangeSystemTime                         = $True
                    settingsBlockDevicesPage                              = $True
                    settingsBlockEaseOfAccessPage                         = $True
                    settingsBlockEditDeviceName                           = $True
                    settingsBlockGamingPage                               = $True
                    settingsBlockNetworkInternetPage                      = $True
                    settingsBlockPersonalizationPage                      = $True
                    settingsBlockPrivacyPage                              = $True
                    settingsBlockRemoveProvisioningPackage                = $True
                    settingsBlockSettingsApp                              = $True
                    settingsBlockSystemPage                               = $True
                    settingsBlockTimeLanguagePage                         = $True
                    settingsBlockUpdateSecurityPage                       = $True
                    sharedUserAppDataAllowed                              = $True
                    smartScreenAppInstallControl                          = 'notConfigured'
                    smartScreenBlockPromptOverride                        = $True
                    smartScreenBlockPromptOverrideForFiles                = $True
                    smartScreenEnableAppInstallControl                    = $True
                    startBlockUnpinningAppsFromTaskbar                    = $True
                    startMenuAppListVisibility                            = 'userDefined'
                    startMenuHideChangeAccountSettings                    = $True
                    startMenuHideFrequentlyUsedApps                       = $True
                    startMenuHideHibernate                                = $True
                    startMenuHideLock                                     = $True
                    startMenuHidePowerButton                              = $True
                    startMenuHideRecentJumpLists                          = $True
                    startMenuHideRecentlyAddedApps                        = $True
                    startMenuHideRestartOptions                           = $True
                    startMenuHideShutDown                                 = $True
                    startMenuHideSignOut                                  = $True
                    startMenuHideSleep                                    = $True
                    startMenuHideSwitchAccount                            = $True
                    startMenuHideUserTile                                 = $True
                    startMenuLayoutEdgeAssetsXml                          = $True
                    startMenuLayoutXml                                    = $True
                    startMenuMode                                         = 'userDefined'
                    startMenuPinnedFolderDocuments                        = 'notConfigured'
                    startMenuPinnedFolderDownloads                        = 'notConfigured'
                    startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                    startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                    startMenuPinnedFolderMusic                            = 'notConfigured'
                    startMenuPinnedFolderNetwork                          = 'notConfigured'
                    startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                    startMenuPinnedFolderPictures                         = 'notConfigured'
                    startMenuPinnedFolderSettings                         = 'notConfigured'
                    startMenuPinnedFolderVideos                           = 'notConfigured'
                    storageBlockRemovableStorage                          = $True
                    storageRequireMobileDeviceEncryption                  = $True
                    storageRestrictAppDataToSystemVolume                  = $True
                    storageRestrictAppInstallToSystemVolume               = $True
                    supportsScopeTags                                     = $True
                    systemTelemetryProxyServer                            = 'FakeStringValue'
                    taskManagerBlockEndTask                               = $True
                    tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                    uninstallBuiltInApps                                  = $True
                    usbBlocked                                            = $True
                    voiceRecordingBlocked                                 = $True
                    webRtcBlockLocalhostIpAddress                         = $True
                    wiFiBlockAutomaticConnectHotspots                     = $True
                    wiFiBlocked                                           = $True
                    wiFiBlockManualConfiguration                          = $True
                    wiFiScanInterval                                      = 25
                    windows10AppsForceUpdateSchedule                      = (New-CimInstance -ClassName MSFT_MicrosoftGraphwindows10AppsForceUpdateSchedule -Property @{
                            runImmediatelyIfAfterStartDateTime = $True
                            recurrence                         = 'none'
                            startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                        } -ClientOnly)
                    windowsSpotlightBlockConsumerSpecificFeatures         = $True
                    windowsSpotlightBlocked                               = $True
                    windowsSpotlightBlockOnActionCenter                   = $True
                    windowsSpotlightBlockTailoredExperiences              = $True
                    windowsSpotlightBlockThirdPartyNotifications          = $True
                    windowsSpotlightBlockWelcomeExperience                = $True
                    windowsSpotlightBlockWindowsTips                      = $True
                    windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                    windowsStoreBlockAutoUpdate                           = $True
                    windowsStoreBlocked                                   = $True
                    windowsStoreEnablePrivateStoreOnly                    = $True
                    wirelessDisplayBlockProjectionToThisDevice            = $True
                    wirelessDisplayBlockUserInputFromReceiver             = $True
                    wirelessDisplayRequirePinForPairing                   = $True
                    Ensure                                                = 'Present'
                    Credential                                            = $Credential
                }

                Mock -CommandName Get-MgBetaDeviceManagementDeviceConfiguration -MockWith {
                    return @{
                        AdditionalProperties = @{
                            energySaverOnBatteryThresholdPercentage               = 7
                            edgeHomepageUrls                                      = @('FakeStringValue')
                            startMenuPinnedFolderSettings                         = 'notConfigured'
                            powerLidCloseActionPluggedIn                          = 'notConfigured'
                            passwordMinimumLength                                 = 7
                            configureTimeZone                                     = 'FakeStringValue'
                            enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                            safeSearchFilter                                      = 'userDefined'
                            edgeKioskModeRestriction                              = 'notConfigured'
                            defenderDetectedMalwareActions                        = @{
                                lowSeverity      = 'deviceDefault'
                                severeSeverity   = 'deviceDefault'
                                moderateSeverity = 'deviceDefault'
                                highSeverity     = 'deviceDefault'
                            }
                            personalizationLockScreenImageUrl                     = 'FakeStringValue'
                            startMenuPinnedFolderDocuments                        = 'notConfigured'
                            startMenuPinnedFolderDownloads                        = 'notConfigured'
                            diagnosticsDataSubmissionMode                         = 'userDefined'
                            '@odata.type'                                         = '#microsoft.graph.windows10GeneralConfiguration'
                            cellularData                                          = 'blocked'
                            defenderScanMaxCpu                                    = 7
                            enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                            passwordMinimumCharacterSetCount                      = 7
                            edgeOpensWith                                         = 'notConfigured'
                            defenderScanType                                      = 'userDefined'
                            printerNames                                          = @('FakeStringValue')
                            authenticationWebSignIn                               = 'notConfigured'
                            defenderPromptForSampleSubmission                     = 'userDefined'
                            powerHybridSleepOnBattery                             = 'notConfigured'
                            powerButtonActionPluggedIn                            = 'notConfigured'
                            edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                            lockScreenTimeoutInSeconds                            = 7
                            defenderSystemScanSchedule                            = 'userDefined'
                            powerHybridSleepPluggedIn                             = 'notConfigured'
                            passwordMinimumAgeInDays                              = 7
                            startMenuPinnedFolderVideos                           = 'notConfigured'
                            privacyAdvertisingId                                  = 'notConfigured'
                            edgeCookiePolicy                                      = 'userDefined'
                            wiFiScanInterval                                      = 7
                            findMyFiles                                           = 'notConfigured'
                            powerLidCloseActionOnBattery                          = 'notConfigured'
                            inkWorkspaceAccessState                               = 'notConfigured'
                            edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                            appsAllowTrustedAppsSideloading                       = 'notConfigured'
                            defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                            edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                            developerUnlockSetting                                = 'notConfigured'
                            defenderFileExtensionsToExclude                       = @('FakeStringValue')
                            systemTelemetryProxyServer                            = 'FakeStringValue'
                            startMenuMode                                         = 'userDefined'
                            edgeHomeButtonConfiguration                           = @{
                                homeButtonCustomURL = 'FakeStringValue'
                                '@odata.type'       = '#microsoft.graph.edgeHomeButtonHidden'
                            }
                            windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                            experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                            powerSleepButtonActionOnBattery                       = 'notConfigured'
                            defenderSignatureUpdateIntervalInHours                = 7
                            enterpriseCloudPrintDiscoveryMaxLimit                 = 7
                            startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                            edgeNewTabPageURL                                     = 'FakeStringValue'
                            displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                            defenderCloudBlockLevel                               = 'notConfigured'
                            displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                            defenderCloudExtendedTimeoutInSeconds                 = 7
                            edgeFavoritesListLocation                             = 'FakeStringValue'
                            startMenuPinnedFolderNetwork                          = 'notConfigured'
                            powerButtonActionOnBattery                            = 'notConfigured'
                            passwordRequiredType                                  = 'deviceDefault'
                            powerSleepButtonActionPluggedIn                       = 'notConfigured'
                            appManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                            lockScreenActivateAppsWithVoice                       = 'notConfigured'
                            edgeFavoritesBarVisibility                            = 'notConfigured'
                            edgeSearchEngine                                      = @{
                                edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                                edgeSearchEngineType             = 'default'
                                '@odata.type'                    = '#microsoft.graph.edgeSearchEngine'
                            }
                            energySaverPluggedInThresholdPercentage               = 7
                            inkWorkspaceAccess                                    = 'notConfigured'
                            activateAppsWithVoice                                 = 'notConfigured'
                            startMenuPinnedFolderPictures                         = 'notConfigured'
                            enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                            authenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                            defenderScheduledQuickScanTime                        = '00:00:00'
                            defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                            startMenuAppListVisibility                            = 'userDefined'
                            windows10AppsForceUpdateSchedule                      = @{
                                startDateTime = '2023-01-01T00:00:00.0000000+00:00'
                                recurrence    = 'none'
                            }
                            networkProxyServer                                    = @{
                                exceptions = @('FakeStringValue')
                                address    = 'FakeStringValue'
                            }
                            startMenuPinnedFolderMusic                            = 'notConfigured'
                            passwordExpirationDays                                = 7
                            edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                            printerDefaultName                                    = 'FakeStringValue'
                            personalizationDesktopImageUrl                        = 'FakeStringValue'
                            microsoftAccountSignInAssistantSettings               = 'notConfigured'
                            edgeFirstRunUrl                                       = 'FakeStringValue'
                            networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                            enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                            defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                            bluetoothAllowedServices                              = @('FakeStringValue')
                            defenderCloudExtendedTimeout                          = 7
                            startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                            passwordMinutesOfInactivityBeforeScreenTimeout        = 7
                            smartScreenAppInstallControl                          = 'notConfigured'
                            startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                            passwordSignInFailureCountBeforeFactoryReset          = 7
                            defenderMonitorFileActivity                           = 'userDefined'
                            edgeKioskResetAfterIdleTimeInMinutes                  = 7
                            defenderProcessesToExclude                            = @('FakeStringValue')
                            defenderDaysBeforeDeletingQuarantinedMalware          = 7
                            enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                            defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                            defenderScheduledScanTime                             = '00:00:00'
                            passwordPreviousPasswordBlockCount                    = 7
                        }
                        description          = 'FakeStringValue'
                        displayName          = 'FakeStringValue'
                        id                   = 'FakeStringValue'
                    }
                }
            }

            It 'Should return Values from the Get method' {
                (Get-TargetResource @testParams).Ensure | Should -Be 'Present'
            }

            It 'Should return false from the Test method' {
                Test-TargetResource @testParams | Should -Be $false
            }

            It 'Should call the Set method' {
                Set-TargetResource @testParams
                Should -Invoke -CommandName Update-MgBetaDeviceManagementDeviceConfiguration -Exactly 1
            }
        }

        Context -Name 'ReverseDSC Tests' -Fixture {
            BeforeAll {
                $Global:CurrentModeIsExport = $true
                $Global:PartialExportFileName = "$(New-Guid).partial.ps1"
                $testParams = @{
                    Credential = $Credential
                }

                Mock -CommandName Get-MgBetaDeviceManagementDeviceConfiguration -MockWith {
                    return @{
                        AdditionalProperties = @{
                            enterpriseCloudPrintResourceIdentifier                = 'FakeStringValue'
                            startMenuHideSwitchAccount                            = $True
                            defenderBlockEndUserAccess                            = $True
                            searchEnableAutomaticIndexSizeManangement             = $True
                            defenderRequireNetworkInspectionSystem                = $True
                            settingsBlockGamingPage                               = $True
                            smartScreenBlockPromptOverrideForFiles                = $True
                            passwordBlockSimple                                   = $True
                            powerLidCloseActionPluggedIn                          = 'notConfigured'
                            defenderRequireCloudProtection                        = $True
                            defenderFilesAndFoldersToExclude                      = @('FakeStringValue')
                            resetProtectionModeBlocked                            = $True
                            startBlockUnpinningAppsFromTaskbar                    = $True
                            networkProxyApplySettingsDeviceWide                   = $True
                            bluetoothAllowedServices                              = @('FakeStringValue')
                            defenderScanArchiveFiles                              = $True
                            lockScreenActivateAppsWithVoice                       = 'notConfigured'
                            defenderScanIncomingMail                              = $True
                            edgeBlockAutofill                                     = $True
                            authenticationAllowSecondaryDevice                    = $True
                            edgeRequireSmartScreen                                = $True
                            windowsSpotlightBlockOnActionCenter                   = $True
                            usbBlocked                                            = $True
                            enableAutomaticRedeployment                           = $True
                            microsoftAccountSignInAssistantSettings               = 'notConfigured'
                            deviceManagementBlockFactoryResetOnMobile             = $True
                            defenderPotentiallyUnwantedAppAction                  = 'deviceDefault'
                            powerButtonActionOnBattery                            = 'notConfigured'
                            startMenuAppListVisibility                            = 'userDefined'
                            lockScreenBlockCortana                                = $True
                            windowsSpotlightConfigureOnLockScreen                 = 'notConfigured'
                            startMenuPinnedFolderPictures                         = 'notConfigured'
                            screenCaptureBlocked                                  = $True
                            webRtcBlockLocalhostIpAddress                         = $True
                            safeSearchFilter                                      = 'userDefined'
                            searchDisableLocation                                 = $True
                            edgeBlockInPrivateBrowsing                            = $True
                            appManagementMSIAllowUserControlOverInstall           = $True
                            defenderSignatureUpdateIntervalInHours                = 25
                            startMenuHideSleep                                    = $True
                            voiceRecordingBlocked                                 = $True
                            edgeFavoritesListLocation                             = 'FakeStringValue'
                            startMenuHideLock                                     = $True
                            wiFiBlockManualConfiguration                          = $True
                            edgeBlockTabPreloading                                = $True
                            configureTimeZone                                     = 'FakeStringValue'
                            edgeBlocked                                           = $True
                            taskManagerBlockEndTask                               = $True
                            settingsBlockAppsPage                                 = $True
                            settingsBlockChangePowerSleep                         = $True
                            copyPasteBlocked                                      = $True
                            settingsBlockNetworkInternetPage                      = $True
                            privacyBlockInputPersonalization                      = $True
                            appManagementPackageFamilyNamesToLaunchAfterLogOn     = @('FakeStringValue')
                            powerLidCloseActionOnBattery                          = 'notConfigured'
                            searchDisableIndexerBackoff                           = $True
                            edgeBlockFullScreenMode                               = $True
                            lockScreenTimeoutInSeconds                            = 25
                            developerUnlockSetting                                = 'notConfigured'
                            storageRestrictAppDataToSystemVolume                  = $True
                            cellularBlockVpn                                      = $True
                            powerHybridSleepPluggedIn                             = 'notConfigured'
                            settingsBlockChangeLanguage                           = $True
                            powerSleepButtonActionOnBattery                       = 'notConfigured'
                            antiTheftModeBlocked                                  = $True
                            defenderMonitorFileActivity                           = 'userDefined'
                            defenderFileExtensionsToExclude                       = @('FakeStringValue')
                            bluetoothBlockDiscoverableMode                        = $True
                            enterpriseCloudPrintOAuthClientIdentifier             = 'FakeStringValue'
                            diagnosticsDataSubmissionMode                         = 'userDefined'
                            uninstallBuiltInApps                                  = $True
                            oneDriveDisableFileSync                               = $True
                            startMenuHideUserTile                                 = $True
                            startMenuHideSignOut                                  = $True
                            defenderDaysBeforeDeletingQuarantinedMalware          = 25
                            privacyAutoAcceptPairingAndConsentPrompts             = $True
                            settingsBlockChangeRegion                             = $True
                            passwordMinimumAgeInDays                              = 25
                            powerHybridSleepOnBattery                             = 'notConfigured'
                            displayAppListWithGdiDPIScalingTurnedOn               = @('FakeStringValue')
                            edgeBlockSearchSuggestions                            = $True
                            settingsBlockSystemPage                               = $True
                            defenderRequireBehaviorMonitoring                     = $True
                            microsoftAccountBlockSettingsSync                     = $True
                            windowsSpotlightBlockWindowsTips                      = $True
                            startMenuHideRecentlyAddedApps                        = $True
                            inkWorkspaceBlockSuggestedApps                        = $True
                            personalizationDesktopImageUrl                        = 'FakeStringValue'
                            edgeHomeButtonConfigurationEnabled                    = $True
                            passwordRequiredType                                  = 'deviceDefault'
                            startMenuPinnedFolderSettings                         = 'notConfigured'
                            connectedDevicesServiceBlocked                        = $True
                            edgeBlockExtensions                                   = $True
                            edgeBlockAddressBarDropdown                           = $True
                            findMyFiles                                           = 'notConfigured'
                            privacyBlockPublishUserActivities                     = $True
                            startMenuHideFrequentlyUsedApps                       = $True
                            '@odata.type'                                         = '#microsoft.graph.windows10GeneralConfiguration'
                            powerSleepButtonActionPluggedIn                       = 'notConfigured'
                            internetSharingBlocked                                = $True
                            startMenuHidePowerButton                              = $True
                            networkProxyAutomaticConfigurationUrl                 = 'FakeStringValue'
                            personalizationLockScreenImageUrl                     = 'FakeStringValue'
                            bluetoothBlockPrePairing                              = $True
                            windowsSpotlightBlockWelcomeExperience                = $True
                            startMenuHideShutDown                                 = $True
                            storageRestrictAppInstallToSystemVolume               = $True
                            windowsSpotlightBlockThirdPartyNotifications          = $True
                            searchDisableAutoLanguageDetection                    = $True
                            edgeShowMessageWhenOpeningInternetExplorerSites       = 'notConfigured'
                            appsAllowTrustedAppsSideloading                       = 'notConfigured'
                            edgeBlockLiveTileDataCollection                       = $True
                            wirelessDisplayBlockProjectionToThisDevice            = $True
                            startMenuHideRestartOptions                           = $True
                            edgeSendIntranetTrafficToInternetExplorer             = $True
                            startMenuPinnedFolderHomeGroup                        = 'notConfigured'
                            edgeBlockWebContentOnNewTabPage                       = $True
                            startMenuLayoutXml                                    = $True
                            searchBlockDiacritics                                 = $True
                            storageBlockRemovableStorage                          = $True
                            enterpriseCloudPrintOAuthAuthority                    = 'FakeStringValue'
                            wirelessDisplayRequirePinForPairing                   = $True
                            defenderScheduledQuickScanTime                        = '00:00:00'
                            edgeAllowStartPagesModification                       = $True
                            defenderRequireRealTimeMonitoring                     = $True
                            authenticationWebSignIn                               = 'notConfigured'
                            lockScreenBlockToastNotifications                     = $True
                            energySaverPluggedInThresholdPercentage               = 25
                            defenderScanMappedNetworkDrivesDuringFullScan         = $True
                            smartScreenBlockPromptOverride                        = $True
                            edgeBlockSendingIntranetTrafficToInternetExplorer     = $True
                            authenticationPreferredAzureADTenantDomainName        = 'FakeStringValue'
                            defenderScanType                                      = 'userDefined'
                            bluetoothBlockAdvertising                             = $True
                            enterpriseCloudPrintDiscoveryMaxLimit                 = 25
                            logonBlockFastUserSwitching                           = $True
                            networkProxyDisableAutoDetect                         = $True
                            cameraBlocked                                         = $True
                            wiFiScanInterval                                      = 25
                            edgeBlockSideloadingExtensions                        = $True
                            settingsBlockEaseOfAccessPage                         = $True
                            microsoftAccountBlocked                               = $True
                            defenderScanRemovableDrivesDuringFullScan             = $True
                            energySaverOnBatteryThresholdPercentage               = 25
                            startMenuHideHibernate                                = $True
                            defenderScanDownloads                                 = $True
                            defenderBlockOnAccessProtection                       = $True
                            defenderCloudBlockLevel                               = 'notConfigured'
                            storageRequireMobileDeviceEncryption                  = $True
                            windowsStoreEnablePrivateStoreOnly                    = $True
                            edgeBlockCompatibilityList                            = $True
                            wiFiBlockAutomaticConnectHotspots                     = $True
                            defenderPotentiallyUnwantedAppActionSetting           = 'userDefined'
                            defenderCloudExtendedTimeout                          = 25
                            edgeHomepageUrls                                      = @('FakeStringValue')
                            cellularBlockDataWhenRoaming                          = $True
                            securityBlockAzureADJoinedDevicesAutoEncryption       = $True
                            smartScreenAppInstallControl                          = 'notConfigured'
                            enterpriseCloudPrintMopriaDiscoveryResourceIdentifier = 'FakeStringValue'
                            bluetoothBlockPromptedProximalConnections             = $True
                            settingsBlockPrivacyPage                              = $True
                            windowsSpotlightBlocked                               = $True
                            tenantLockdownRequireNetworkDuringOutOfBoxExperience  = $True
                            startMenuPinnedFolderDocuments                        = 'notConfigured'
                            systemTelemetryProxyServer                            = 'FakeStringValue'
                            lockScreenAllowTimeoutConfiguration                   = $True
                            defenderSystemScanSchedule                            = 'userDefined'
                            windowsSpotlightBlockConsumerSpecificFeatures         = $True
                            searchDisableUseLocation                              = $True
                            appsBlockWindowsStoreOriginatedApps                   = $True
                            startMenuPinnedFolderNetwork                          = 'notConfigured'
                            edgeBlockPrinting                                     = $True
                            settingsBlockEditDeviceName                           = $True
                            printerNames                                          = @('FakeStringValue')
                            settingsBlockUpdateSecurityPage                       = $True
                            startMenuMode                                         = 'userDefined'
                            searchBlockWebResults                                 = $True
                            edgePreventCertificateErrorOverride                   = $True
                            passwordRequired                                      = $True
                            defenderScanNetworkFiles                              = $True
                            startMenuPinnedFolderMusic                            = 'notConfigured'
                            cortanaBlocked                                        = $True
                            searchEnableRemoteQueries                             = $True
                            messagingBlockSync                                    = $True
                            startMenuPinnedFolderVideos                           = 'notConfigured'
                            enterpriseCloudPrintDiscoveryEndPoint                 = 'FakeStringValue'
                            experienceDoNotSyncBrowserSettings                    = 'notConfigured'
                            edgeDisableFirstRunPage                               = $True
                            edgeCookiePolicy                                      = 'userDefined'
                            inkWorkspaceAccessState                               = 'notConfigured'
                            windows10AppsForceUpdateSchedule                      = @{
                                runImmediatelyIfAfterStartDateTime = $True
                                recurrence                         = 'none'
                                startDateTime                      = '2023-01-01T00:00:00.0000000+00:00'
                            }
                            dataProtectionBlockDirectMemoryAccess                 = $True
                            experienceBlockErrorDialogWhenNoSIM                   = $True
                            settingsBlockPersonalizationPage                      = $True
                            wirelessDisplayBlockUserInputFromReceiver             = $True
                            startMenuPinnedFolderPersonalFolder                   = 'notConfigured'
                            activateAppsWithVoice                                 = 'notConfigured'
                            edgeClearBrowsingDataOnExit                           = $True
                            passwordPreviousPasswordBlockCount                    = 25
                            edgeBlockSearchEngineCustomization                    = $True
                            deviceManagementBlockManualUnenroll                   = $True
                            edgeBlockSavingHistory                                = $True
                            inkWorkspaceAccess                                    = 'notConfigured'
                            startMenuHideRecentJumpLists                          = $True
                            privacyBlockActivityFeed                              = $True
                            settingsBlockChangeSystemTime                         = $True
                            defenderDisableCatchupQuickScan                       = $True
                            smartScreenEnableAppInstallControl                    = $True
                            edgeBlockDeveloperTools                               = $True
                            edgeKioskModeRestriction                              = 'notConfigured'
                            lockScreenBlockActionCenterNotifications              = $True
                            privacyAdvertisingId                                  = 'notConfigured'
                            settingsBlockSettingsApp                              = $True
                            settingsBlockAccountsPage                             = $True
                            certificatesBlockManualRootCertificateInstallation    = $True
                            edgeBlockJavaScript                                   = $True
                            edgeSyncFavoritesWithInternetExplorer                 = $True
                            startMenuLayoutEdgeAssetsXml                          = $True
                            windowsSpotlightBlockTailoredExperiences              = $True
                            defenderPromptForSampleSubmission                     = 'userDefined'
                            edgeBlockAccessToAboutFlags                           = $True
                            messagingBlockMMS                                     = $True
                            edgeBlockEditFavorites                                = $True
                            printerDefaultName                                    = 'FakeStringValue'
                            experienceBlockDeviceDiscovery                        = $True
                            privacyDisableLaunchExperience                        = $True
                            edgeTelemetryForMicrosoft365Analytics                 = 'notConfigured'
                            nfcBlocked                                            = $True
                            searchDisableIndexingRemovableDrive                   = $True
                            powerButtonActionPluggedIn                            = 'notConfigured'
                            settingsBlockRemoveProvisioningPackage                = $True
                            edgeKioskResetAfterIdleTimeInMinutes                  = 25
                            passwordMinutesOfInactivityBeforeScreenTimeout        = 25
                            printerBlockAddition                                  = $True
                            defenderScanScriptsLoadedInInternetExplorer           = $True
                            defenderDisableCatchupFullScan                        = $True
                            edgeRequiredExtensionPackageFamilyNames               = @('FakeStringValue')
                            bluetoothBlocked                                      = $True
                            settingsBlockAddProvisioningPackage                   = $True
                            passwordMinimumLength                                 = 25
                            startMenuHideChangeAccountSettings                    = $True
                            defenderSubmitSamplesConsentType                      = 'sendSafeSamplesAutomatically'
                            edgeBlockPopups                                       = $True
                            networkProxyServer                                    = @{
                                useForLocalAddresses = $True
                                exceptions           = @('FakeStringValue')
                                address              = 'FakeStringValue'
                            }
                            startMenuPinnedFolderDownloads                        = 'notConfigured'
                            settingsBlockDevicesPage                              = $True
                            wiFiBlocked                                           = $True
                            windowsStoreBlocked                                   = $True
                            edgeBlockPrelaunch                                    = $True
                            gameDvrBlocked                                        = $True
                            experienceBlockTaskSwitcher                           = $True
                            edgeBlockPasswordManager                              = $True
                            passwordSignInFailureCountBeforeFactoryReset          = 25
                            passwordMinimumCharacterSetCount                      = 25
                            searchDisableIndexingEncryptedItems                   = $True
                            appManagementMSIAlwaysInstallWithElevatedPrivileges   = $True
                            cellularData                                          = 'blocked'
                            defenderScheduledScanTime                             = '00:00:00'
                            edgeEnterpriseModeSiteListLocation                    = 'FakeStringValue'
                            defenderProcessesToExclude                            = @('FakeStringValue')
                            defenderDetectedMalwareActions                        = @{
                                lowSeverity      = 'deviceDefault'
                                severeSeverity   = 'deviceDefault'
                                moderateSeverity = 'deviceDefault'
                                highSeverity     = 'deviceDefault'
                            }
                            edgeHomeButtonConfiguration                           = @{
                                homeButtonCustomURL = 'FakeStringValue'
                                '@odata.type'       = '#microsoft.graph.edgeHomeButtonHidden'
                            }
                            cryptographyAllowFipsAlgorithmPolicy                  = $True
                            sharedUserAppDataAllowed                              = $True
                            edgeFirstRunUrl                                       = 'FakeStringValue'
                            edgeBlockSendingDoNotTrackHeader                      = $True
                            edgeOpensWith                                         = 'notConfigured'
                            defenderScheduleScanEnableLowCpuPriority              = $True
                            windowsStoreBlockAutoUpdate                           = $True
                            messagingBlockRichCommunicationServices               = $True
                            edgeNewTabPageURL                                     = 'FakeStringValue'
                            passwordRequireWhenResumeFromIdleState                = $True
                            passwordExpirationDays                                = 25
                            displayAppListWithGdiDPIScalingTurnedOff              = @('FakeStringValue')
                            settingsBlockTimeLanguagePage                         = $True
                            locationServicesBlocked                               = $True
                            defenderScanMaxCpu                                    = 25
                            edgeFavoritesBarVisibility                            = 'notConfigured'
                            accountsBlockAddingNonMicrosoftAccountEmail           = $True
                            defenderCloudExtendedTimeoutInSeconds                 = 25
                            cellularBlockVpnWhenRoaming                           = $True
                            startMenuPinnedFolderFileExplorer                     = 'notConfigured'
                            edgeSearchEngine                                      = @{
                                edgeSearchEngineOpenSearchXmlUrl = 'FakeStringValue'
                                edgeSearchEngineType             = 'default'
                                '@odata.type'                    = '#microsoft.graph.edgeSearchEngine'
                            }
                        }
                        description          = 'FakeStringValue'
                        displayName          = 'FakeStringValue'
                        id                   = 'FakeStringValue'
                        supportsScopeTags    = $True

                    }
                }
            }
            It 'Should Reverse Engineer resource from the Export method' {
                $result = Export-TargetResource @testParams
                $result | Should -Not -BeNullOrEmpty
            }
        }
    }
}

Invoke-Command -ScriptBlock $Global:DscHelper.CleanupScript -NoNewScope
